MainApp.OpenAsFrz:Function OpenAsFrz(f As FolderItem) As Boolean  Dim i As Integer  if (f=NIL)or(f.exists=false) then    return false  end if  i=RomChk(f)  if i=0 then    i=getWizSelect  elseif i=-1 then    return false  end if  Select case i  case 1    if Wiz1Edit.OpenAsFrz(f) then      Wiz1Edit.Show    end if    return true  case 2    if Wiz2Edit.OpenAsFrz(f) then      Wiz2Edit.Show    end if    return true  case 3    if Wiz3Edit.OpenAsFrz(f) then      Wiz3Edit.Show    end if    return true  else        return false  end Select  End FunctionMainApp.OpenDocument:Sub OpenDocument(item As FolderItem)  if OpenAsFrz(item) then  end ifEnd SubMainApp.EnableMenuItems:Sub EnableMenuItems()  AppleWizEdit.Enabled=true  FileOpen.Enabled=true  FileImport.Enabled=true  importWiz1.Enabled=true  importWiz2.Enabled=true  importWiz3.Enabled=true  if WizOnePath<>NIL then    WindowWiz1Edit.Enabled=true  else    WindowWiz1Edit.Enabled=false  end if  if WizTwoPath<>NIL then    WindowWiz2Edit.Enabled=true  else    WindowWiz2Edit.Enabled=false  end if  if WizThreePath<>NIL then    WindowWiz3Edit.Enabled=true  else    WindowWiz3Edit.Enabled=false  end ifEnd SubMainApp.Open:Sub Open()  WizEditInit  Wiz1Edit.Hide  Wiz2Edit.Hide  Wiz3Edit.HideEnd SubWizPublic.FrzDataSize:Function FrzDataSize() As Integer  return 82849End FunctionWizPublic.WizThreeOffSet:Function WizThreeOffSet() As Integer  return &H6402End FunctionWizPublic.getWizSelect:Function getWizSelect() As Integer  Dim w As WizSelect1  WizSelectResult=0  w= New WizSelect1  w.ShowModal  return WizSelectResultEnd FunctionWizPublic.WizEditInit:Sub WizEditInit()  WizSelectResult=0    ReDim WizOne(FrzDataSize)  ReDim WizTwo(FrzDataSize)  ReDim WizThree(FrzDataSize)  WizOnePath=NIL  WizTwoPath=NIL  WizThreePath=NILEnd SubWizPublic.WizThreeDataSize:Function WizThreeDataSize() As Integer  return 96End FunctionWizPublic.StrHEX:Function StrHEX(p As Integer) As String  Dim s As String  s=HEX(p)  Select case LenB(s)  case 0    s="00"  case 1    s="0"+s  end  return sEnd FunctionWizPublic.WizThreeOffSet2:Function WizThreeOffSet2() As Integer  return &H7802End FunctionWizPublic.ItemSort:Sub ItemSort()  Dim i,j,k As Integer  //バブルソート  k=7  while k>=0    j=-1    for i=1 to k      if ItemBank(i-1)>ItemBank(i) then        j=i-1        ItemSwap(i,j)      end    next    k=j  Wend  //アイテムなしの処理  for i=0 to 7    if ItemBank(i)=255 then      ItemName(i)=false      ItemName(i)=false    end if  nextEnd SubWizPublic.ItemSwap:Sub ItemSwap(k As Integer,d As Integer)  Dim b As Integer  Dim n As Boolean  Dim s As Boolean    b=ItemBank(k)  n=ItemName(k)  s=ItemSoubi(k)  ItemBank(k)=ItemBank(d)  ItemName(k)=ItemName(d)  ItemSoubi(k)=ItemSoubi(d)  ItemBank(d)=b  ItemName(d)=n  ItemSoubi(d)=sEnd SubWizPublic.WizTwoDataSize:Function WizTwoDataSize() As Integer  return 96End FunctionWizPublic.WizTwoOffSet:Function WizTwoOffSet() As Integer  return 25602End FunctionWizPublic.WizTwoOffSet2:Function WizTwoOffSet2() As Integer  return 30722End FunctionWizPublic.WizOneDataSize:Function WizOneDataSize() As Integer  return 256End FunctionWizPublic.WizOneOffset:Function WizOneOffset() As Integer  return &H6002End FunctionWizPublic.ToMojiT:Function ToMojiT(p As Integer) As String  if (p>=32)and(p<=126) then//JISコードそのまま    return chr(p)  elseif (p>=134)and(p<=144) then//を-っ    return chr(&HA6+p-134)  elseif (p>=145)and(p<=159) then//あ-そ    return chr(&HB1+p-145)  elseif (p>=166)and(p<=176) then//ヲ-ｯ    return chr(&HA6+p-166)  elseif (p>=177)and(p<=221) then//ア-ン    return chr(&HB1+p-177)  elseif (p>=224)and(p<=255) then//た-ん    return chr(&HC0+p-224)  else    Select case p    case 160      return "of"    case 161      return "｡"    case 162      return "薬"    case 163      return "巻物"    case 164      return ","    case 165      return "･"    case 176      return "ｰ"    case 222      return "ﾞ"    case 223      return "ﾟ"    else      return ""    end Select  end ifEnd FunctionWizPublic.RomChk:Function RomChk(f As FolderItem) As Integer  Dim rf As BinaryStream  Dim s As String  if f=NIL then    return -1  end if  rf=f.OpenAsBinaryFile(false)  if rf=NIL then    return -1  end if  if rf.Length<>FrzDataSize then    rf.Close    return -1  end if  rf.Position=&H12496  s=chr(rf.ReadByte)  s=s+chr(rf.ReadByte)  s=s+chr(rf.ReadByte)  s=s+chr(rf.ReadByte)  rf.Close  if s="1987" then    return 1  elseif s="1989" then    return 2  else    return 0  end ifEnd FunctionWizPublic.WizOneOffset2:Function WizOneOffset2() As Integer  return &H6002End FunctionWizSelect1.Open:Sub Open()  WizSelectResult=0  rbFF(3).Value=trueEnd SubWizSelect1.rbFF.Action:Sub Action(Index As Integer)  WizSelectResult=IndexEnd SubWizSelect1.btnCancel.Action:Sub Action()  WizSelectResult=0  closeEnd SubWizSelect1.btnOK.Action:Sub Action()  closeEnd SubWiz1Edit.OpenAsFrz:Function OpenAsFrz(f As FolderItem) As Boolean  Dim rf As BinaryStream  Dim i As Integer  //エラーチェック  if f.length<>FrzDataSize then    return false  end if  rf=f.OpenAsBinaryFile(false)  if rf=NIL then    return false  end if  for i=0 to FrzDataSize-1    WizOne(i)=rf.ReadByte  next  rf.Close  WizOnePath=f  //  GetMode=false  ListChange  DispAllName  return trueEnd FunctionWiz1Edit.GetName:Function GetName(index As Integer) As String  Dim nLen As Integer  Dim i As Integer  Dim s As String    nLen=WizOne(WizOneOffSet+WizOneDataSize*index+1)    if nLen=0 then        return "名前無し"    elseif nLen>8 then        return "無効な名前データ"    end if    s=""    for i=1 to nLen        s=s+Wiz1ToMoji(WizOne(WizOneOffSet+1+WizOneDataSize*index+i))    next    return sEnd FunctionWiz1Edit.Wiz1ToMoji:Function Wiz1ToMoji(p As Integer) As String  if (p>=0)and(p<=9) then //数字    return chr(p+48)  elseif (p>=10)and(p<=35) then//大文字英語    return chr(&H41+p-10)  elseif (p>=56)and(p<=101) then//カタカナ    return chr(&HB1+p-56)  elseif (p>=110)and(p<=155) then//ひらがな    return chr(&HB1+p-110)  else    Select case p    case 42      return "/"    case 43      return "*"    case 45      return "!"    case 46      return "?"    case 48      return "`"    case 49      return "."    case 50      return ","    case 52      return "+"    case 53      return "-"    case 54      return "ﾟ"    case 55      return "ﾞ"    case 102      return "ｧ"    case 103      return "ｨ"    case 104      return "ｪ"    case 105      return "ｫ"    case 106      return "ｯ"    case 107      return "ｬ"    case 108      return "ｭ"    case 109      return "ｮ"    case 156      return "ｯ"    case 157      return "ｬ"    case 158      return "ｭ"    case 159      return "ｮ"    else      return ""    end Select  end ifEnd FunctionWiz1Edit.DispAllName:Sub DispAllName()  Dim i As Integer  lbList.DeleteAllRows  for i=0 to 19    lbList.AddRow GetNameAndStat(i)  next  lbList.ListIndex=0End SubWiz1Edit.ListUP:Sub ListUP()  SwapData(lbList.ListIndex,lbList.ListIndex-1)  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  lbList.List(lbList.ListIndex-1)=GetNameAndStat(lbList.ListIndex-1)  lbList.ListIndex=lbList.ListIndex-1  //lbList.RefreshEnd SubWiz1Edit.ListDown:Sub ListDown()  SwapData(lbList.ListIndex,lbList.ListIndex+1)  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  lbList.List(lbList.ListIndex+1)=GetNameAndStat(lbList.ListIndex+1)  lbList.ListIndex=lbList.ListIndex+1  //lbList.RefreshEnd SubWiz1Edit.SwapData:Sub SwapData(s As Integer, d As Integer)  Dim i,ss,dd,b As Integer  if (s<0)or(s>19)or(d<0)or(d>19)or(s=d) then    return  end if  ss=WizOneOffSet+WizOneDataSize*s  dd=WizOneOffSet+WizOneDataSize*d  for i=0 to WizOneDataSize-1    b=WizOne(ss+i)    WizOne(ss+i)=WizOne(dd+i)    WizOne(dd+i)=b  nextEnd SubWiz1Edit.GetStatus:Function GetStatus(index As Integer) As String  Dim p,j As Integer  Dim i As Integer  Dim G,H,F As String  if (index<0)or(index>19) then    return "無効なindex値です"  end if   p=WizOneOffSet+WizOneDataSize*index    //種族  Select case WizOne(p+10)  case 0    H="Hum"  case 1    H="Elf"  case 2    H="Dwa"  case 3    H="Gno"  case 4    H="Hob"  else    H="???"  end Select    //職業  Select case WizOne(p+11)  case 0    F="Fig"  case 1    F="Mag"  case 2    F="Pri"  case 3    F="Thi"  case 4    F="Bis"  case 5    F="Sum"  case 6    F="Lor"  case 7    F="Nin"  else    F="???"  end Select    //属性  Select case WizOne(p+12)  case 0    G="G"  case 1    G="N"  case 2    G="E"  else    G="?"  end Select  return G+"-"+F+" "+HEnd FunctionWiz1Edit.GetNameAndStat:Function GetNameAndStat(index As Integer) As String  Dim S As String  Dim i As Integer  s=GetName(index)  if LenB(s)<8 then    for i=1 to 8-LenB(s)      s=s+" "    next  end if  s=s+GetStatus(Index)  return sEnd FunctionWiz1Edit.ListChange:Sub ListChange()  if GetMode=false then    btnSet.Enabled=false    btnCancel.Enabled=false    btnSAVE.Enabled=true    if lbList.Enabled=false then      lbList.Enabled=true    end if    Select case lbList.ListIndex    case -1      btnUp.Enabled=false      btnDown.Enabled=false    case 0      btnUp.Enabled=false      btnDown.Enabled=true    case 19      btnUp.Enabled=true      btnDown.Enabled=false    else      btnUp.Enabled=true      btnDown.Enabled=true    end Select  else    lbList.Enabled=false    btnUp.Enabled=false    btnDown.Enabled=false    btnSet.Enabled=true    btnCancel.Enabled=true    btnSAVE.Enabled=false  end if  SetInput(GetMode)End SubWiz1Edit.ToEdit:Sub ToEdit()  Dim Index As Integer  Index=lbList.ListIndex  if (Index>=0)and(Index<=19) then    GetIndex=Index    GetPrmToEdit  end ifEnd SubWiz1Edit.GetPrmToEdit:Sub GetPrmToEdit()  Dim p,i,j As Integer  Dim S As String  p=WizOneOffSet+WizOneDataSize*GetIndex    //名前  stName.Text=GetName(GetIndex)    //種族  pmSYUZOKU.ListIndex=WizOne(p+10)    //職業  pmSYOKUGYOU.ListIndex=WizOne(p+11)  //属性  pmZOKUSEI.ListIndex=WizOne(p+12)    //各種パラメータ  efCHIKARA.text=Str(WizOne(p+13))  efCHIE.text=Str(WizOne(p+14))  efSHINKOU.text=Str(WizOne(p+15))  efSEIMEI.text=Str(WizOne(p+16))  efSUBAYASA.Text=Str(WizOne(p+17))  efUN.text=Str(WizOne(p+18))    //お金  s=StrHex(WizOne(p+19))  s=s+StrHex(WizOne(p+20))  s=s+StrHex(WizOne(p+21))  s=s+StrHex(WizOne(p+22))  s=s+StrHex(WizOne(p+23))  s=s+StrHex(WizOne(p+24))    efOKANE.text=s    //経験値  s=StrHex(WizOne(p+25))  s=s+StrHex(WizOne(p+26))  s=s+StrHex(WizOne(p+27))  s=s+StrHex(WizOne(p+28))  s=s+StrHex(WizOne(p+29))  s=s+StrHex(WizOne(p+30))  efKEIKEN.text=s    //HP  efHP.Text=Str(WizOne(p+31)+WizOne(p+32)*256)  efHPMAX.Text=Str(WizOne(p+33)+WizOne(p+34)*256)    //レベル  efLEVEL.Text=Str(WizOne(p+35)*256+WizOne(p+36))    //状態  pmJOUTAI.ListIndex=WizOne(p+37)    //年齢  efNENREI.Text=Str(WizOne(p+38))    //基本AC  efAC.Text=Str(ToSignedByte(WizOne(p+40)))    //毒  if WizOne(p+97)=1 then    cbDOKU.Value=true  else    cbDOKU.Value=false  end if    //勲章">"  if BitWiseAnd(WizOne(p+98),1)=1 then    cbKUNSYOU.value=true  else    cbKUNSYOU.value=false  end if    //Magic詠唱回数  s=""  for i=0 to 6     s=s+Str(i+1)+":"+Hex(WizOne(p+41+i))+"/"+Hex(WizOne(p+55+i))+" "  next  stMag.text=s  //Priest詠唱回数  s=""  for i=0 to 6     s=s+Str(i+1)+":"+Hex(WizOne(p+48+i))+"/"+Hex(WizOne(p+62+i))+" "  next  stPri.Text=s    //アイテム情報    ItemToBank(GetIndex)  BankToPoolEnd SubWiz1Edit.SetPrmFromEdit:Sub SetPrmFromEdit()  Dim p,i,j As Integer  Dim S As String  p=WizOneOffSet+WizOneDataSize*GetIndex    //まず属性種族*職業  WizOne(p+10)=pmSYUZOKU.ListIndex  WizOne(p+11)=pmSYOKUGYOU.ListIndex  WizOne(p+12)=pmZOKUSEI.ListIndex    //各種パラメータ    WizOne(p+13)=ChkPrm(Val(efCHIKARA.text))  WizOne(p+14)=ChkPrm(Val(efCHIE.text))  WizOne(p+15)=ChkPrm(Val(efSHINKOU.text))  WizOne(p+16)=ChkPrm(Val(efSEIMEI.text))  WizOne(p+17)=ChkPrm(Val(efSUBAYASA.Text))  WizOne(p+18)=ChkPrm(Val(efUN.text))    //お金  chgReet(efOKANE.text)  WizOne(p+19)=chg(0)  WizOne(p+20)=chg(1)  WizOne(p+21)=chg(2)  WizOne(p+22)=chg(3)  WizOne(p+23)=chg(4)  WizOne(p+24)=chg(5)    //経験値  chgReet(efKEIKEN.text)  WizOne(p+25)=chg(0)  WizOne(p+26)=chg(1)  WizOne(p+27)=chg(2)  WizOne(p+28)=chg(3)  WizOne(p+29)=chg(4)  WizOne(p+30)=chg(5)    //HP  i=Val(efHP.Text)  if i<1 then    i=1  elseif (i>9000) then    i=9000  end if  WizOne(p+31)=i mod 256  WizOne(p+32)=i \ 256  i=Val(efHPMAX.Text)  if i<1 then    i=1  elseif (i>9000) then    i=9000  end if  WizOne(p+33)=i mod 256  WizOne(p+34)=i \ 256    //レベル  i=Val(efLEVEL.Text)  if i<1 then    i=1  elseif (i>9999) then    i=9999  end if  WizOne(p+35)=i \ 256  WizOne(p+36)=i mod 256    //状態  WizOne(p+37)=pmJOUTAI.ListIndex    //年齢  WizOne(p+38)=Val(efNENREI.Text)    //基本AC  WizOne(p+40)=Val(efAC.Text)    //毒  if cbDOKU.Value=true then    WizOne(p+97)=1  else    WizOne(p+97)=0  end if    //勲章">"  if cbKUNSYOU.value=true then    WizOne(p+98)=1  else    WizOne(p+98)=0  end if    //呪文設定  if cbSpel(2).Value=true then    for i=0 to 6      WizOne(p+41+i)=Val("&HF")      WizOne(p+55+i)=Val("&HF")      WizOne(p+48+i)=Val("&HF")      WizOne(p+62+i)=Val("&HF")    next  elseif cbSpel(0).Value=true then    for i=0 to 6      WizOne(p+41+i)=Val("&HF")      WizOne(p+55+i)=Val("&HF")    next  elseif cbSpel(1).Value=true then    for i=0 to 6      WizOne(p+48+i)=Val("&HF")      WizOne(p+62+i)=Val("&HF")    next  end if  if cbSpel(5).Value=true then    WizOne(p+69)=Val("&HFF")    WizOne(p+70)=Val("&HFF")    WizOne(p+71)=Val("&HFF")    WizOne(p+72)=Val("&HFF")    WizOne(p+73)=Val("&HFF")    WizOne(p+74)=Val("&HFF")    WizOne(p+75)=Val("&HFF")  elseif cbSpel(3).Value=true then    WizOne(p+69)=Val("&HFF")    WizOne(p+70)=Val("&HFF")    WizOne(p+71)=Val("&HFF")  elseif cbSpel(4).Value=true then    WizOne(p+72)=Val("&HFF")    WizOne(p+73)=Val("&HFF")    WizOne(p+74)=Val("&HFF")    WizOne(p+75)=Val("&HFF")  end if      PoolToItem(p)  GetIndex=-1End SubWiz1Edit.chgReet:Sub chgReet(s As String)  Dim i,L,r As Integer  Dim ss As String  ss=s  //文字数を12文字に  L=LenB(ss)  if (L<12) then    for i=1 to 12-L      ss="0"+ss    next  elseif L>12 then    ss=Left(ss,12)  end if    chg(5)=Val("&H"+Mid(ss,11,2))  chg(4)=Val("&H"+Mid(ss,9,2))  chg(3)=Val("&H"+Mid(ss,7,2))  chg(2)=Val("&H"+Mid(ss,5,2))  chg(1)=Val("&H"+Mid(ss,3,2))  chg(0)=Val("&H"+Mid(ss,1,2))End SubWiz1Edit.SetInput:Sub SetInput(v As Boolean)  dim i As Integer  if pmZOKUSEI.Enabled<>v then    pmZOKUSEI.Enabled=v    pmSYOKUGYOU.Enabled=v    pmSYUZOKU.Enabled=v    efLEVEL.Enabled=v    efNENREI.Enabled=v    efKEIKEN.Enabled=v    efHP.Enabled=v    efHPMAX.Enabled=v    efAC.Enabled=v    efCHIKARA.Enabled=v    efCHIE.Enabled=v    efSHINKOU.Enabled=v    efSEIMEI.Enabled=v    efSUBAYASA.Enabled=v    efUN.Enabled=v    cbDOKU.Enabled=v    pmJOUTAI.Enabled=v    efOKANE.Enabled=v    cbKUNSYOU.Enabled=v        for i=0 to 5      cbSpel(i).Enabled=v    next        for i=0 to 7      cbItem(i).Enabled=v      cbItem(i+8).Enabled=v      btnPeast(i).Enabled=v      stItem(i).Enabled=v    next    lbItem.Enabled=v    btnSort.Enabled=v      end if  if v=false then    if stName.Text<>"" then      stName.Text=""      pmZOKUSEI.ListIndex=-1      pmSYOKUGYOU.ListIndex=-1      pmSYUZOKU.ListIndex=-1      efLEVEL.Text=""      efNENREI.Text=""      efKEIKEN.Text=""      efHP.Text=""      efHPMAX.Text=""      efAC.Text=""      efCHIKARA.Text=""      efCHIE.Text=""      efSHINKOU.Text=""      efSEIMEI.Text=""      efSUBAYASA.Text=""      efUN.Text=""      cbDOKU.Value=false      pmJOUTAI.ListIndex=-1      efOKANE.Text=""      cbKUNSYOU.Value=false      stMag.Text=""      stPri.Text=""      for i=0 to 5        cbSpel(i).Value=false      next      for i=0 to 7        cbItem(i).Value=false        cbItem(i+8).Value=false        stItem(i).text=""      next    end if  end ifEnd SubWiz1Edit.SaveFrz:Function SaveFrz(f As FolderItem) As Boolean  Dim wf As BinaryStream  Dim i As Integer  //エラーチェック  if f=NIL then    return false  end if      wf=f.CreateBinaryFile("text")  if wf=NIL then    return false  end if  for i=0 to FrzDataSize-1    wf.WriteByte WizOne(i)  next  wf.Close  WizOnePath=f    return trueEnd FunctionWiz1Edit.ChkPrm:Function ChkPrm(p As Integer) As Integer  Dim r As Integer  r=p  if r<1 then    r=1  elseif r>33 then    r=15+18  end if  return rEnd FunctionWiz1Edit.ToSignedByte:Function ToSignedByte(p As Integer) As Integer  Dim r As Integer  r=p  if (r>127) then    r=r-256  end if  return rEnd FunctionWiz1Edit.ItemToBank:Sub ItemToBank(Index As Integer)  Dim i,j,p As Integer  p=WizOneOffSet+WizOneDataSize*Index  for i=0 to 7    ItemSoubi(i)=false    ItemName(i)=false    ItemBank(i)=255  next  iCount=WizOne(p+92)  if iCount<>0 then    for i=0 to iCount-1      j=WizOne(p+76+i)      //装備      if ((j\128)mod 2)=1 then        ItemSoubi(i)=true      else        ItemSoubi(i)=false      end if      //不確定名      if ((j\32)mod 2)=1 then        ItemName(i)=true      else        ItemName(i)=false      end if      if WizOne(p+84+i)<=100 then        ItemBank(i)=WizOne(p+84+i)      end if    next  end ifEnd SubWiz1Edit.ItemPeast:Sub ItemPeast(index As Integer)  if lbItem.ListIndex>=0 then    ItemPool(Index)=Val(lbItem.Cell(lbItem.ListIndex,0))    stItem(Index).text=lbItem.Cell(lbItem.ListIndex,1)    cbItem(Index).Value=false    cbItem(Index+8).Value=false  end ifEnd SubWiz1Edit.PoolToBank:Sub PoolToBank()  Dim i As Integer  for i=0 to 7    //装備    ItemSoubi(i)=cbItem(i).Value    ItemName(i)=cbItem(i+8).Value    ItemBank(i)=ItemPool(i)  nextEnd SubWiz1Edit.BankToPool:Sub BankToPool()  Dim i As Integer  for i=0 to 7    cbItem(i).value=ItemSoubi(i)    cbItem(i+8).value=ItemName(i)    ItemPool(i)=ItemBank(i)    if ItemBank(i)<=lbItem.ListCount then      stItem(i).text=lbItem.Cell(ItemBank(i),1)    else      stItem(i).text="なし"    end if  nextEnd SubWiz1Edit.PoolToItem:Sub PoolToItem(p As Integer)  Dim i,j,k,x As Integer  PoolToBank  ItemSort  BankToPool  k=0  for i=0 to 7    j=0    if cbItem(i).Value=true then      j=128    end if    if cbItem(i+8).Value=true then      j=j+32    end if    WizOne(p+76+i)=j    if ItemPool(i)=255 then      WizOne(p+84+i)=0    else      WizOne(p+84+i)=ItemPool(i)    end if    if ItemPool(i)<>255 then      k=k+1    end if  next  WizOne(p+92)=kEnd SubWiz1Edit.SetlbItem:Sub SetlbItem()  lbItem.DeleteAllRows  lbItem.AddRow ""  lbItem.Cell(0,0)="0"  lbItem.Cell(0,1)="がらくた"  lbItem.AddRow ""  lbItem.Cell(1,0)="1"  lbItem.Cell(1,1)="剣"  lbItem.AddRow ""  lbItem.Cell(2,0)="2"  lbItem.Cell(2,1)="短剣"  lbItem.AddRow ""  lbItem.Cell(3,0)="3"  lbItem.Cell(3,1)="メイス"  lbItem.AddRow ""  lbItem.Cell(4,0)="4"  lbItem.Cell(4,1)="フレイル"  lbItem.AddRow ""  lbItem.Cell(5,0)="5"  lbItem.Cell(5,1)="杖"  lbItem.AddRow ""  lbItem.Cell(6,0)="6"  lbItem.Cell(6,1)="短刀"  lbItem.AddRow ""  lbItem.Cell(7,0)="7"  lbItem.Cell(7,1)="小型の盾"  lbItem.AddRow ""  lbItem.Cell(8,0)="8"  lbItem.Cell(8,1)="盾"  lbItem.AddRow ""  lbItem.Cell(9,0)="9"  lbItem.Cell(9,1)="ローブ"  lbItem.AddRow ""  lbItem.Cell(10,0)="10"  lbItem.Cell(10,1)="皮の鎧"  lbItem.AddRow ""  lbItem.Cell(11,0)="11"  lbItem.Cell(11,1)="鎖帷子"  lbItem.AddRow ""  lbItem.Cell(12,0)="12"  lbItem.Cell(12,1)="胸当て"  lbItem.AddRow ""  lbItem.Cell(13,0)="13"  lbItem.Cell(13,1)="鎧"  lbItem.AddRow ""  lbItem.Cell(14,0)="14"  lbItem.Cell(14,1)="兜"  lbItem.AddRow ""  lbItem.Cell(15,0)="15"  lbItem.Cell(15,1)="治療の薬"  lbItem.AddRow ""  lbItem.Cell(16,0)="16"  lbItem.Cell(16,1)="毒消しの薬"  lbItem.AddRow ""  lbItem.Cell(17,0)="17"  lbItem.Cell(17,1)="切り裂きの剣"  lbItem.AddRow ""  lbItem.Cell(18,0)="18"  lbItem.Cell(18,1)="良い短剣"  lbItem.AddRow ""  lbItem.Cell(19,0)="19"  lbItem.Cell(19,1)="粉砕のメイス"  lbItem.AddRow ""  lbItem.Cell(20,0)="20"  lbItem.Cell(20,1)="鉄の杖"  lbItem.AddRow ""  lbItem.Cell(21,0)="21"  lbItem.Cell(21,1)="眠りの薬"  lbItem.AddRow ""  lbItem.Cell(22,0)="22"  lbItem.Cell(22,1)="固い皮鎧"  lbItem.AddRow ""  lbItem.Cell(23,0)="23"  lbItem.Cell(23,1)="光る鎖帷子"  lbItem.AddRow ""  lbItem.Cell(24,0)="24"  lbItem.Cell(24,1)="ますらおの鎧"  lbItem.AddRow ""  lbItem.Cell(25,0)="25"  lbItem.Cell(25,1)="鉄の盾"  lbItem.AddRow ""  lbItem.Cell(26,0)="26"  lbItem.Cell(26,1)="銅の鎧"  lbItem.AddRow ""  lbItem.Cell(27,0)="27"  lbItem.Cell(27,1)="苦痛の巻物"  lbItem.AddRow ""  lbItem.Cell(28,0)="28"  lbItem.Cell(28,1)="炎の巻物"  lbItem.AddRow ""  lbItem.Cell(29,0)="29"  lbItem.Cell(29,1)="なまくらな剣"  lbItem.AddRow ""  lbItem.Cell(30,0)="30"  lbItem.Cell(30,1)="幻滅の短剣"  lbItem.AddRow ""  lbItem.Cell(31,0)="31"  lbItem.Cell(31,1)="災いのメイス"  lbItem.AddRow ""  lbItem.Cell(32,0)="32"  lbItem.Cell(32,1)="堅い杖"  lbItem.AddRow ""  lbItem.Cell(33,0)="33"  lbItem.Cell(33,1)="ﾄﾞﾗｺﾞﾝｽﾚｲﾔｰ"  lbItem.AddRow ""  lbItem.Cell(34,0)="34"  lbItem.Cell(34,1)="忍耐の兜"  lbItem.AddRow ""  lbItem.Cell(35,0)="35"  lbItem.Cell(35,1)="腐った皮鎧"  lbItem.AddRow ""  lbItem.Cell(36,0)="36"  lbItem.Cell(36,1)="錆びた鎖帷子"  lbItem.AddRow ""  lbItem.Cell(37,0)="37"  lbItem.Cell(37,1)="ひび割れた胸当て"  lbItem.AddRow ""  lbItem.Cell(38,0)="38"  lbItem.Cell(38,1)="歪んだ盾"  lbItem.AddRow ""  lbItem.Cell(39,0)="39"  lbItem.Cell(39,1)="宝石の指輪"  lbItem.AddRow ""  lbItem.Cell(40,0)="40"  lbItem.Cell(40,1)="苦しみの巻物"  lbItem.AddRow ""  lbItem.Cell(41,0)="41"  lbItem.Cell(41,1)="隠れ身の薬"  lbItem.AddRow ""  lbItem.Cell(42,0)="42"  lbItem.Cell(42,1)="真っ二つの剣"  lbItem.AddRow ""  lbItem.Cell(43,0)="43"  lbItem.Cell(43,1)="最強の短剣"  lbItem.AddRow ""  lbItem.Cell(44,0)="44"  lbItem.Cell(44,1)="力のメイス"  lbItem.AddRow ""  lbItem.Cell(45,0)="45"  lbItem.Cell(45,1)="明かりの巻物"  lbItem.AddRow ""  lbItem.Cell(46,0)="46"  lbItem.Cell(46,1)="暗闇の巻物"  lbItem.AddRow ""  lbItem.Cell(47,0)="47"  lbItem.Cell(47,1)="銅の小手"  lbItem.AddRow ""  lbItem.Cell(48,0)="48"  lbItem.Cell(48,1)="豪華な皮鎧"  lbItem.AddRow ""  lbItem.Cell(49,0)="49"  lbItem.Cell(49,1)="ｴﾙﾌの鎖帷子"  lbItem.AddRow ""  lbItem.Cell(50,0)="50"  lbItem.Cell(50,1)="極上の鎧"  lbItem.AddRow ""  lbItem.Cell(51,0)="51"  lbItem.Cell(51,1)="支えの盾"  lbItem.AddRow ""  lbItem.Cell(52,0)="52"  lbItem.Cell(52,1)="悪の兜"  lbItem.AddRow ""  lbItem.Cell(53,0)="53"  lbItem.Cell(53,1)="快復の薬"  lbItem.AddRow ""  lbItem.Cell(54,0)="54"  lbItem.Cell(54,1)="守りの指輪"  lbItem.AddRow ""  lbItem.Cell(55,0)="55"  lbItem.Cell(55,1)="ﾜｰｽﾚｲﾔｰ"  lbItem.AddRow ""  lbItem.Cell(56,0)="56"  lbItem.Cell(56,1)="ﾒｲｼﾞｽﾏｯｼｬｰ"  lbItem.AddRow ""  lbItem.Cell(57,0)="57"  lbItem.Cell(57,1)="蛇のメイス"  lbItem.AddRow ""  lbItem.Cell(58,0)="58"  lbItem.Cell(58,1)="沈黙の杖"  lbItem.AddRow ""  lbItem.Cell(59,0)="59"  lbItem.Cell(59,1)="ｶｼﾅｰﾄの剣"  lbItem.AddRow ""  lbItem.Cell(60,0)="60"  lbItem.Cell(60,1)="戒めの指輪"  lbItem.AddRow ""  lbItem.Cell(61,0)="61"  lbItem.Cell(61,1)="炎の杖"  lbItem.AddRow ""  lbItem.Cell(62,0)="62"  lbItem.Cell(62,1)="悪の鎖帷子"  lbItem.AddRow ""  lbItem.Cell(63,0)="63"  lbItem.Cell(63,1)="中立の鎧"  lbItem.AddRow ""  lbItem.Cell(64,0)="64"  lbItem.Cell(64,1)="悪の盾"  lbItem.AddRow ""  lbItem.Cell(65,0)="65"  lbItem.Cell(65,1)="窒息の指輪"  lbItem.AddRow ""  lbItem.Cell(66,0)="66"  lbItem.Cell(66,1)="転移の兜"  lbItem.AddRow ""  lbItem.Cell(67,0)="67"  lbItem.Cell(67,1)="一撃の巻物"  lbItem.AddRow ""  lbItem.Cell(68,0)="68"  lbItem.Cell(68,1)="破滅の短剣"  lbItem.AddRow ""  lbItem.Cell(69,0)="69"  lbItem.Cell(69,1)="切り裂きの短刀"  lbItem.AddRow ""  lbItem.Cell(70,0)="70"  lbItem.Cell(70,1)="病めるメイス"  lbItem.AddRow ""  lbItem.Cell(71,0)="71"  lbItem.Cell(71,1)="ねじれた杖"  lbItem.AddRow ""  lbItem.Cell(72,0)="72"  lbItem.Cell(72,1)="早業の短刀"  lbItem.AddRow ""  lbItem.Cell(73,0)="73"  lbItem.Cell(73,1)="呪われたローブ"  lbItem.AddRow ""  lbItem.Cell(74,0)="74"  lbItem.Cell(74,1)="破滅の皮鎧"  lbItem.AddRow ""  lbItem.Cell(75,0)="75"  lbItem.Cell(75,1)="呪いの鎖帷子"  lbItem.AddRow ""  lbItem.Cell(76,0)="76"  lbItem.Cell(76,1)="悪魔の胸当て"  lbItem.AddRow ""  lbItem.Cell(77,0)="77"  lbItem.Cell(77,1)="虚ろの盾"  lbItem.AddRow ""  lbItem.Cell(78,0)="78"  lbItem.Cell(78,1)="古びた兜"  lbItem.AddRow ""  lbItem.Cell(79,0)="79"  lbItem.Cell(79,1)="希望の胸当て"  lbItem.AddRow ""  lbItem.Cell(80,0)="80"  lbItem.Cell(80,1)="銀の小手"  lbItem.AddRow ""  lbItem.Cell(81,0)="81"  lbItem.Cell(81,1)="悪のサーベル"  lbItem.AddRow ""  lbItem.Cell(82,0)="82"  lbItem.Cell(82,1)="ｿｳﾙｽﾚｲﾔｰ"  lbItem.AddRow ""  lbItem.Cell(83,0)="83"  lbItem.Cell(83,1)="盗賊の短刀"  lbItem.AddRow ""  lbItem.Cell(84,0)="84"  lbItem.Cell(84,1)="英雄の鎧"  lbItem.AddRow ""  lbItem.Cell(85,0)="85"  lbItem.Cell(85,1)="聖なる鎧"  lbItem.AddRow ""  lbItem.Cell(86,0)="86"  lbItem.Cell(86,1)="村正"  lbItem.AddRow ""  lbItem.Cell(87,0)="87"  lbItem.Cell(87,1)="手裏剣"  lbItem.AddRow ""  lbItem.Cell(88,0)="88"  lbItem.Cell(88,1)="氷の鎖帷子"  lbItem.AddRow ""  lbItem.Cell(89,0)="89"  lbItem.Cell(89,1)="悪の鎧"  lbItem.AddRow ""  lbItem.Cell(90,0)="90"  lbItem.Cell(90,1)="守りの盾"  lbItem.AddRow ""  lbItem.Cell(91,0)="91"  lbItem.Cell(91,1)="快復の指輪"  lbItem.AddRow ""  lbItem.Cell(92,0)="92"  lbItem.Cell(92,1)="覇邪の指輪"  lbItem.AddRow ""  lbItem.Cell(93,0)="93"  lbItem.Cell(93,1)="死の指輪"  lbItem.AddRow ""  lbItem.Cell(94,0)="94"  lbItem.Cell(94,1)="ワードナの魔除け"  lbItem.AddRow ""  lbItem.Cell(95,0)="95"  lbItem.Cell(95,1)="熊の置物"  lbItem.AddRow ""  lbItem.Cell(96,0)="96"  lbItem.Cell(96,1)="蛙の置物"  lbItem.AddRow ""  lbItem.Cell(97,0)="97"  lbItem.Cell(97,1)="青銅の鍵"  lbItem.AddRow ""  lbItem.Cell(98,0)="98"  lbItem.Cell(98,1)="銀の鍵"  lbItem.AddRow ""  lbItem.Cell(99,0)="99"  lbItem.Cell(99,1)="金の鍵"  lbItem.AddRow ""  lbItem.Cell(100,0)="100"  lbItem.Cell(100,1)="ブルーリボン"  lbItem.AddRow ""  lbItem.Cell(101,0)="255"  lbItem.Cell(101,1)="なし"End SubWiz1Edit.KAISEKI:Sub KAISEKI()  Dim i As Integer  Dim rf As TextInputStream  Dim S As String  lbItem.DeleteAllRows  rf=PreferencesFolder.Child("WizEdit1解析.pref").OpenAsTextFile  if rf<>NIL then    i=0    do      s=rf.ReadLine      lbItem.AddRow ""      lbItem.Cell(i,0)=NthField(s,",",1)      lbItem.Cell(i,1)=NthField(s,",",2)      i=i+1    loop until rf.EOF    rf.Close  else    lbItem.AddRow ""    lbItem.cell(i,0)="0"    lbItem.Cell(i,1)="がらくた"    for i=1 to 140      lbItem.AddRow ""      lbItem.cell(i,0)=Str(i)      lbItem.Cell(i,1)="不明:"+Str(i)    next    lbItem.AddRow ""    lbItem.cell(i,0)="255"    lbItem.Cell(i,1)="なし"  end if  lbItem.ListIndex=0End SubWiz1Edit.EnableMenuItems:Sub EnableMenuItems()  if GetMode=false then    FileSave.Enabled=true  else    FileSave.Enabled=false  end ifEnd SubWiz1Edit.Open:Sub Open()  GetMode=falseEnd SubWiz1Edit.lbList.Open:Sub Open()  btnUp.Enabled=false  btnDown.Enabled=true  lbList.ListIndex=0End SubWiz1Edit.lbList.Change:Sub Change()  ListChangeEnd SubWiz1Edit.btnUP.Action:Sub Action()  if GetMode=false then    ListUP  end ifEnd SubWiz1Edit.btnDOWN.Action:Sub Action()  if GetMode=false then    ListDown  end ifEnd SubWiz1Edit.btnGet.Action:Sub Action()  GetMode=true  ListChange  ToEdit  me.Caption="初期値へ"  tpPrm.RefreshEnd SubWiz1Edit.btnSET.Action:Sub Action()  GetMode=false  SetPrmFromEdit  ListChange  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  btnGet.caption="編集開始"End SubWiz1Edit.btnSAVE.Action:Sub Action()  if SaveFrz(WizOnePath) then  end ifEnd SubWiz1Edit.btnCancel.Action:Sub Action()  GetMode=false  ListChange  btnGet.caption="編集開始"End SubWiz1Edit.lbItem.KeyDown:Function KeyDown(key As String) As Boolean  Dim i As Integer  dim wf As TextoutputStream  if (Key="s")or(Key="S") then    if keyboard.shiftKey=true then      wf=PreferencesFolder.Child("WizEdit1解析.pref").CreateTextFile      for i=0 to me.ListCount-1        wf.WriteLine me.Cell(i,0)+","+me.Cell(i,1)      next      wf.Close            wf=PreferencesFolder.Child("WizEdit1解析.Text").CreateTextFile      for i=0 to me.ListCount-1        wf.WriteLine "lbItem.AddRow "+chr(34)+chr(34)        wf.WriteLine "lbItem.Cell("+Str(i)+",0)="+chr(34)+me.Cell(i,0)+chr(34)        wf.WriteLine "lbItem.Cell("+Str(i)+",1)="+chr(34)+me.Cell(i,1)+chr(34)      next      wf.Close    end if  end ifEnd FunctionWiz1Edit.lbItem.Open:Sub Open()  SetlbItemEnd SubWiz1Edit.btnSort.Action:Sub Action()  PoolToBank  ItemSort  BankToPoolEnd SubWiz1Edit.btnPeast.Action:Sub Action(Index As Integer)  ItemPeast(Index)End SubWiz1Edit.btnItemSet.Action:Sub Action()  Dim i As Integer  dim wf As TextoutputStream  lbItem.Cell(lbItem.ListIndex,1)=efItemSet.Text  efItemSet.Text=""  lbItem.ListIndex=lbItem.ListIndex+1  End SubWiz2Edit.OpenAsFrz:Function OpenAsFrz(f As FolderItem) As Boolean  Dim rf As BinaryStream  Dim i As Integer  //エラーチェック  if f.length<>FrzDataSize then    return false  end if  rf=f.OpenAsBinaryFile(false)  if rf=NIL then    return false  end if  for i=0 to FrzDataSize-1    WizTwo(i)=rf.ReadByte  next  rf.Close  WizTwoPath=f  //  GetMode=false  ListChange  DispAllName  return trueEnd FunctionWiz2Edit.GetName:Function GetName(index As Integer) As String  Dim nLen As Integer  Dim i As Integer  Dim s As String    nLen=WizTwo(WizTwoOffSet+WizTwoDataSize*index+1)    if nLen=0 then        return "名前無し"    elseif nLen>8 then        return "無効な名前データ"    end if    s=""    for i=1 to nLen        s=s+ToMoji(WizTwo(WizTwoOffSet+1+WizTwoDataSize*index+i))    next    return sEnd FunctionWiz2Edit.ToMoji:Function ToMoji(p As Integer) As String  return ToMojiT(p)End FunctionWiz2Edit.DispAllName:Sub DispAllName()  Dim i As Integer  lbList.DeleteAllRows  for i=0 to 19    lbList.AddRow GetNameAndStat(i)  next  lbList.ListIndex=0End SubWiz2Edit.ListUP:Sub ListUP()  SwapData(lbList.ListIndex,lbList.ListIndex-1)  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  lbList.List(lbList.ListIndex-1)=GetNameAndStat(lbList.ListIndex-1)  lbList.ListIndex=lbList.ListIndex-1  //lbList.RefreshEnd SubWiz2Edit.ListDown:Sub ListDown()  SwapData(lbList.ListIndex,lbList.ListIndex+1)  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  lbList.List(lbList.ListIndex+1)=GetNameAndStat(lbList.ListIndex+1)  lbList.ListIndex=lbList.ListIndex+1  //lbList.RefreshEnd SubWiz2Edit.SwapData:Sub SwapData(s As Integer, d As Integer)  Dim i,ss,dd,b As Integer  if (s<0)or(s>19)or(d<0)or(d>19)or(s=d) then    return  end if  ss=WizTwoOffSet+WizTwoDataSize*s  dd=WizTwoOffSet+WizTwoDataSize*d  for i=0 to WizTwoDataSize-1    b=WizTwo(ss+i)    WizTwo(ss+i)=WizTwo(dd+i)    WizTwo(dd+i)=b  nextEnd SubWiz2Edit.GetStatus:Function GetStatus(index As Integer) As String  Dim p,j As Integer  Dim i As Integer  Dim G,H,F As String  if (index<0)or(index>19) then    return "無効なindex値です"  end if   p=WizTwo(WizTwoOffSet+WizTwoDataSize*index+10)  //まず属性  j=BitWiseAnd(p,3)  if (j mod 2)=1 then    G="N"  else    if (j\2 mod 2)=0 then      G="G"    else      G="E"    end if  end if  //種族  j=BitWiseAnd(p\32,7)  Select case j  case 0    H="Hum"  case 1    H="Elf"  case 2    H="Dwa"  case 3    H="Gno"  case 4    H="Hob"  else    H="???"  end Select  //職業  j=BitWiseAnd(p\4,7)  Select case j  case 0    F="Fig"  case 1    F="Mag"  case 2    F="Pri"  case 3    F="Thi"  case 4    F="Bis"  case 5    F="Sum"  case 6    F="Lor"  case 7    F="Nin"  else    F="???"  end Select  return G+"-"+F+" "+HEnd FunctionWiz2Edit.GetNameAndStat:Function GetNameAndStat(index As Integer) As String  Dim S As String  Dim i As Integer  s=GetName(index)  if LenB(s)<8 then    for i=1 to 8-LenB(s)      s=s+" "    next  end if  s=s+GetStatus(Index)  return sEnd FunctionWiz2Edit.ListChange:Sub ListChange()  if GetMode=false then    btnSet.Enabled=false    btnCancel.Enabled=false    btnSAVE.Enabled=true    if lbList.Enabled=false then      lbList.Enabled=true    end if    Select case lbList.ListIndex    case -1      btnUp.Enabled=false      btnDown.Enabled=false    case 0      btnUp.Enabled=false      btnDown.Enabled=true    case 19      btnUp.Enabled=true      btnDown.Enabled=false    else      btnUp.Enabled=true      btnDown.Enabled=true    end Select  else    lbList.Enabled=false    btnUp.Enabled=false    btnDown.Enabled=false    btnSet.Enabled=true    btnCancel.Enabled=true    btnSAVE.Enabled=false  end if  SetInput(GetMode)End SubWiz2Edit.ToEdit:Sub ToEdit()  Dim Index As Integer  Index=lbList.ListIndex  if (Index>=0)and(Index<=19) then    GetIndex=Index    GetPrmToEdit  end ifEnd SubWiz2Edit.GetPrmToEdit:Sub GetPrmToEdit()  Dim p,i,j As Integer  Dim S As String  p=WizTwoOffSet+WizTwoDataSize*GetIndex    //名前  stName.Text=GetName(GetIndex)    //まず属性  i=WizTwo(p+10)  j=BitWiseAnd(i,3)  if (j mod 2)=1 then    pmZOKUSEI.ListIndex=1  else    if (j\2 mod 2)=0 then      pmZOKUSEI.ListIndex=0    else      pmZOKUSEI.ListIndex=2    end if  end if  //種族  pmSYUZOKU.ListIndex=BitWiseAnd(i\32,7)    //職業  pmSYOKUGYOU.ListIndex=BitWiseAnd(i\4,7)    //各種パラメータ  efCHIKARA.text=Str(WizTwo(p+11))  efCHIE.text=Str(WizTwo(p+12))  efSHINKOU.text=Str(WizTwo(p+13))  efSEIMEI.text=Str(WizTwo(p+14))  efSUBAYASA.Text=Str(WizTwo(p+15))  efUN.text=Str(WizTwo(p+16))    //お金  s=StrHex(WizTwo(p+17))  s=s+StrHex(WizTwo(p+18))  s=s+StrHex(WizTwo(p+19))  s=s+StrHex(WizTwo(p+20))  s=s+StrHex(WizTwo(p+21))  s=s+StrHex(WizTwo(p+22))    efOKANE.text=s    //経験値  s=StrHex(WizTwo(p+23))  s=s+StrHex(WizTwo(p+24))  s=s+StrHex(WizTwo(p+25))  s=s+StrHex(WizTwo(p+26))  s=s+StrHex(WizTwo(p+27))  s=s+StrHex(WizTwo(p+28))  efKEIKEN.text=s    //HP  efHP.Text=Str(WizTwo(p+29)+WizTwo(p+30)*256)  efHPMAX.Text=Str(WizTwo(p+31)+WizTwo(p+32)*256)    //レベル  efLEVEL.Text=Str(WizTwo(p+33)*256+WizTwo(p+34))    //状態  pmJOUTAI.ListIndex=WizTwo(p+35)    //年齢  efNENREI.Text=Str(WizTwo(p+36))    //基本AC  efAC.Text=Str(ToSignedByte(WizTwo(p+38)))    //毒  if WizTwo(p+84)=1 then    cbDOKU.Value=true  else    cbDOKU.Value=false  end if    //勲章">"  i=WizTwo(p+88)  if BitWiseAnd(i,1)=1 then    cbKUNSYOU(1).value=true  else    cbKUNSYOU(1).value=false  end if  //勲章"G"  if BitWiseAnd(i\2,1)=1 then    cbKUNSYOU(2).value=true  else    cbKUNSYOU(2).value=false  end if  //勲章"*"  if BitWiseAnd(i\4,1)=1 then    cbKUNSYOU(3).value=true  else    cbKUNSYOU(3).value=false  end if  //Magic詠唱回数  s=""  for i=0 to 6     s=s+Str(i+1)+":"+Hex(WizTwo(p+39+i)\16)+"/"+Hex(WizTwo(p+39+i) mod 16)+" "  next  stMag.text=s  //Priest詠唱回数  s=""  for i=0 to 6     s=s+Str(i+1)+":"+Hex(WizTwo(p+46+i)\16)+"/"+Hex(WizTwo(p+46+i) mod 16)+" "  next  stPri.Text=s    //アイテム情報  ItemToBank(GetIndex)  ItemSort  BankToPoolEnd SubWiz2Edit.SetPrmFromEdit:Sub SetPrmFromEdit()  Dim p,i,j As Integer  Dim S As String  p=WizTwoOffSet+WizTwoDataSize*GetIndex    //まず属性  Select case pmZOKUSEI.ListIndex  case 0    i=0  case 1    i=1  case 2    i=2  end select    //種族*職業  WizTwo(p+10)=pmSYUZOKU.ListIndex*32+pmSYOKUGYOU.ListIndex*4+i    //各種パラメータ    WizTwo(p+11)=ChkPrm(Val(efCHIKARA.text))  WizTwo(p+12)=ChkPrm(Val(efCHIE.text))  WizTwo(p+13)=ChkPrm(Val(efSHINKOU.text))  WizTwo(p+14)=ChkPrm(Val(efSEIMEI.text))  WizTwo(p+15)=ChkPrm(Val(efSUBAYASA.Text))  WizTwo(p+16)=ChkPrm(Val(efUN.text))    //お金  chgReet(efOKANE.text)  WizTwo(p+17)=chg(0)  WizTwo(p+18)=chg(1)  WizTwo(p+19)=chg(2)  WizTwo(p+20)=chg(3)  WizTwo(p+21)=chg(4)  WizTwo(p+22)=chg(5)    //経験値  chgReet(efKEIKEN.text)  WizTwo(p+23)=chg(0)  WizTwo(p+24)=chg(1)  WizTwo(p+25)=chg(2)  WizTwo(p+26)=chg(3)  WizTwo(p+27)=chg(4)  WizTwo(p+28)=chg(5)    //HP  i=Val(efHP.Text)  if i<1 then    i=1  elseif (i>9000) then    i=9000  end if  WizTwo(p+29)=i mod 256  WizTwo(p+30)=i \ 256  i=Val(efHPMAX.Text)  if i<1 then    i=1  elseif (i>9000) then    i=9000  end if  WizTwo(p+31)=i mod 256  WizTwo(p+32)=i \ 256    //レベル  i=Val(efLEVEL.Text)  if i<1 then    i=1  elseif (i>9999) then    i=9999  end if  WizTwo(p+33)=i \ 256  WizTwo(p+34)=i mod 256    //状態  WizTwo(p+35)=pmJOUTAI.ListIndex    //年齢  WizTwo(p+36)=Val(efNENREI.Text)    //基本AC  WizTwo(p+38)=Val(efAC.Text)    //毒  if cbDOKU.Value=true then    WizTwo(p+84)=1  else    WizTwo(p+84)=0  end if    //勲章">"    if cbKUNSYOU(1).value=true then    i=1  else    i=0  end if  //勲章"G"  if cbKUNSYOU(2).value=true then    i=i+2  end if  //勲章"*"  if cbKUNSYOU(3).value=true then    i=i+4  end if  WizTwo(p+88)=i      //呪文設定  if cbSpel(2).Value=true then    for i=0 to 6      WizTwo(p+39+i)=Val("&HFF")      WizTwo(p+46+i)=Val("&HFF")    next  elseif cbSpel(0).Value=true then    for i=0 to 6      WizTwo(p+39+i)=Val("&H99")    next  elseif cbSpel(1).Value=true then    for i=0 to 6      WizTwo(p+46+i)=Val("&H99")    next  end if  if cbSpel(5).Value=true then    for i=0 to 6      WizTwo(p+53+i)=Val("&HFF")      WizTwo(p+60+i)=Val("&HFF")    next  elseif cbSpel(3).Value=true then    for i=0 to 6      WizTwo(p+53+i)=Val("&HFF")    next  elseif cbSpel(4).Value=true then    for i=0 to 6      WizTwo(p+54+i)=Val("&HFF")    next  end if  PoolToBank  ItemSort  BankToPool  PoolToItem(p)  GetIndex=-1End SubWiz2Edit.chgReet:Sub chgReet(s As String)  Dim i,L,r As Integer  Dim ss As String  ss=s  //文字数を12文字に  L=LenB(ss)  if (L<12) then    for i=1 to 12-L      ss="0"+ss    next  elseif L>12 then    ss=Left(ss,12)  end if    chg(5)=Val("&H"+Mid(ss,11,2))  chg(4)=Val("&H"+Mid(ss,9,2))  chg(3)=Val("&H"+Mid(ss,7,2))  chg(2)=Val("&H"+Mid(ss,5,2))  chg(1)=Val("&H"+Mid(ss,3,2))  chg(0)=Val("&H"+Mid(ss,1,2))End SubWiz2Edit.SetInput:Sub SetInput(v As Boolean)  dim i As Integer  if pmZOKUSEI.Enabled<>v then    pmZOKUSEI.Enabled=v    pmSYOKUGYOU.Enabled=v    pmSYUZOKU.Enabled=v    efLEVEL.Enabled=v    efNENREI.Enabled=v    efKEIKEN.Enabled=v    efHP.Enabled=v    efHPMAX.Enabled=v    efAC.Enabled=v    efCHIKARA.Enabled=v    efCHIE.Enabled=v    efSHINKOU.Enabled=v    efSEIMEI.Enabled=v    efSUBAYASA.Enabled=v    efUN.Enabled=v    cbDOKU.Enabled=v    pmJOUTAI.Enabled=v    efOKANE.Enabled=v    for i=1 to 3      cbKUNSYOU(i).Enabled=v    next        for i=0 to 5      cbSpel(i).Enabled=v    next        for i=0 to 7      cbItem(i).Enabled=v      cbItem(i+8).Enabled=v      btnPeast(i).Enabled=v      stItem(i).Enabled=v    next    lbItem.Enabled=v    btnSort.Enabled=v      end if  if v=false then    if stName.Text<>"" then      stName.Text=""      pmZOKUSEI.ListIndex=-1      pmSYOKUGYOU.ListIndex=-1      pmSYUZOKU.ListIndex=-1      efLEVEL.Text=""      efNENREI.Text=""      efKEIKEN.Text=""      efHP.Text=""      efHPMAX.Text=""      efAC.Text=""      efCHIKARA.Text=""      efCHIE.Text=""      efSHINKOU.Text=""      efSEIMEI.Text=""      efSUBAYASA.Text=""      efUN.Text=""      cbDOKU.Value=false      pmJOUTAI.ListIndex=-1      efOKANE.Text=""      for i=1 to 3        cbKUNSYOU(i).Value=false      next      stMag.Text=""      stPri.Text=""      for i=0 to 5        cbSpel(i).Value=false      next      for i=0 to 7        cbItem(i).Value=false        cbItem(i+8).Value=false        stItem(i).text=""      next    end if  end ifEnd SubWiz2Edit.SaveFrz:Function SaveFrz(f As FolderItem) As Boolean  Dim wf As BinaryStream  Dim i As Integer  //エラーチェック  if f=NIL then    return false  end if  //  for i=0 to WizTwoDataSize*20-1    WizTwo(i+WizTwoOffSet2)=WizTwo(i+WizTwoOffSet)  next  wf=f.CreateBinaryFile("text")  if wf=NIL then    return false  end if  for i=0 to FrzDataSize-1    wf.WriteByte WizTwo(i)  next  wf.Close  WizTwoPath=f    return trueEnd FunctionWiz2Edit.ChkPrm:Function ChkPrm(p As Integer) As Integer  Dim r As Integer  r=p  if r<1 then    r=1  elseif r>30 then    r=15+18  end if  return rEnd FunctionWiz2Edit.ToSignedByte:Function ToSignedByte(p As Integer) As Integer  Dim r As Integer  r=p  if (r>127) then    r=r-256  end if  return rEnd FunctionWiz2Edit.ItemToBank:Sub ItemToBank(Index As Integer)  Dim i,j,p As Integer  p=WizTwoOffSet+WizTwoDataSize*Index  for i=0 to 7    ItemSoubi(i)=false    ItemName(i)=false    ItemBank(i)=255  next  for i=0 to 7    j=WizTwo(p+67+i)    //装備    if ((j\128)mod 2)=1 then      ItemSoubi(i)=true    end if    //不確定名    if ((j\32)mod 2)=1 then      ItemName(i)=true    end if    if WizTwo(p+75+i)<=110 then      ItemBank(i)=WizTwo(p+75+i)    end if  nextEnd SubWiz2Edit.ItemPeast:Sub ItemPeast(index As Integer)  if lbItem.ListIndex>=0 then    ItemPool(Index)=Val(lbItem.Cell(lbItem.ListIndex,0))    stItem(Index).text=lbItem.Cell(lbItem.ListIndex,1)    cbItem(Index).Value=false    cbItem(Index+8).Value=false  end ifEnd SubWiz2Edit.PoolToBank:Sub PoolToBank()  Dim i As Integer  for i=0 to 7    //装備    ItemSoubi(i)=cbItem(i).Value    ItemName(i)=cbItem(i+8).Value    ItemBank(i)=ItemPool(i)  nextEnd SubWiz2Edit.BankToPool:Sub BankToPool()  Dim i As Integer  for i=0 to 7    cbItem(i).value=ItemSoubi(i)    cbItem(i+8).value=ItemName(i)    ItemPool(i)=ItemBank(i)    if ItemBank(i)<=lbItem.ListCount then      stItem(i).text=lbItem.Cell(ItemBank(i),1)    else      stItem(i).text="なし"    end if  nextEnd SubWiz2Edit.PoolToItem:Sub PoolToItem(p As Integer)  Dim i,j,k As Integer  k=0  for i=0 to 7    j=0    if cbItem(i).Value=true then      j=128    end if    if cbItem(i+8).Value=true then      j=j+32    end if    WizTwo(p+67+i)=j        WizTwo(p+75+i)=ItemPool(i)    if ItemPool(i)<>255 then      k=k+1    end if  next  WizTwo(p+83)=kEnd SubWiz2Edit.SetlbItem:Sub SetlbItem()  lbItem.DeleteAllRows  lbItem.AddRow ""  lbItem.Cell(0,0)="0"  lbItem.Cell(0,1)="がらくた"  lbItem.AddRow ""  lbItem.Cell(1,0)="1"  lbItem.Cell(1,1)="イアリシンの宝珠"  lbItem.AddRow ""  lbItem.Cell(2,0)="2"  lbItem.Cell(2,1)="中立の水晶"  lbItem.AddRow ""  lbItem.Cell(3,0)="3"  lbItem.Cell(3,1)="悪の水晶"  lbItem.AddRow ""  lbItem.Cell(4,0)="4"  lbItem.Cell(4,1)="善の水晶"  lbItem.AddRow ""  lbItem.Cell(5,0)="5"  lbItem.Cell(5,1)="ビン詰めの船"  lbItem.AddRow ""  lbItem.Cell(6,0)="6"  lbItem.Cell(6,1)="大地の杖"  lbItem.AddRow ""  lbItem.Cell(7,0)="7"  lbItem.Cell(7,1)="空気の魔除け"  lbItem.AddRow ""  lbItem.Cell(8,0)="8"  lbItem.Cell(8,1)="聖水"  lbItem.AddRow ""  lbItem.Cell(9,0)="9"  lbItem.Cell(9,1)="炎の杖"  lbItem.AddRow ""  lbItem.Cell(10,0)="10"  lbItem.Cell(10,1)="金のメダリオン"  lbItem.AddRow ""  lbItem.Cell(11,0)="11"  lbItem.Cell(11,1)="ﾐｭｰｽﾞﾌｪｽの宝珠"  lbItem.AddRow ""  lbItem.Cell(12,0)="12"  lbItem.Cell(12,1)="蝶のナイフ"  lbItem.AddRow ""  lbItem.Cell(13,0)="13"  lbItem.Cell(13,1)="短剣"  lbItem.AddRow ""  lbItem.Cell(14,0)="14"  lbItem.Cell(14,1)="段平"  lbItem.AddRow ""  lbItem.Cell(15,0)="15"  lbItem.Cell(15,1)="メイス"  lbItem.AddRow ""  lbItem.Cell(16,0)="16"  lbItem.Cell(16,1)="杖"  lbItem.AddRow ""  lbItem.Cell(17,0)="17"  lbItem.Cell(17,1)="斧"  lbItem.AddRow ""  lbItem.Cell(18,0)="18"  lbItem.Cell(18,1)="戦斧"  lbItem.AddRow ""  lbItem.Cell(19,0)="19"  lbItem.Cell(19,1)="短刀"  lbItem.AddRow ""  lbItem.Cell(20,0)="20"  lbItem.Cell(20,1)="フレイル"  lbItem.AddRow ""  lbItem.Cell(21,0)="21"  lbItem.Cell(21,1)="盾"  lbItem.AddRow ""  lbItem.Cell(22,0)="22"  lbItem.Cell(22,1)="鉄の盾"  lbItem.AddRow ""  lbItem.Cell(23,0)="23"  lbItem.Cell(23,1)="魔法使いのローブ"  lbItem.AddRow ""  lbItem.Cell(24,0)="24"  lbItem.Cell(24,1)="皮の鎧"  lbItem.AddRow ""  lbItem.Cell(25,0)="25"  lbItem.Cell(25,1)="鎖帷子"  lbItem.AddRow ""  lbItem.Cell(26,0)="26"  lbItem.Cell(26,1)="胸当て"  lbItem.AddRow ""  lbItem.Cell(27,0)="27"  lbItem.Cell(27,1)="鎧"  lbItem.AddRow ""  lbItem.Cell(28,0)="28"  lbItem.Cell(28,1)="兜"  lbItem.AddRow ""  lbItem.Cell(29,0)="29"  lbItem.Cell(29,1)="傷薬"  lbItem.AddRow ""  lbItem.Cell(30,0)="30"  lbItem.Cell(30,1)="毒消し"  lbItem.AddRow ""  lbItem.Cell(31,0)="31"  lbItem.Cell(31,1)="短剣+1"  lbItem.AddRow ""  lbItem.Cell(32,0)="32"  lbItem.Cell(32,1)="段平+1"  lbItem.AddRow ""  lbItem.Cell(33,0)="33"  lbItem.Cell(33,1)="メイス+1"  lbItem.AddRow ""  lbItem.Cell(34,0)="34"  lbItem.Cell(34,1)="戦斧+1"  lbItem.AddRow ""  lbItem.Cell(35,0)="35"  lbItem.Cell(35,1)="ヌンチャク"  lbItem.AddRow ""  lbItem.Cell(36,0)="36"  lbItem.Cell(36,1)="短刀+1"  lbItem.AddRow ""  lbItem.Cell(37,0)="37"  lbItem.Cell(37,1)="眠りの巻物"  lbItem.AddRow ""  lbItem.Cell(38,0)="38"  lbItem.Cell(38,1)="皮鎧+1"  lbItem.AddRow ""  lbItem.Cell(39,0)="39"  lbItem.Cell(39,1)="鎖帷子+1"  lbItem.AddRow ""  lbItem.Cell(40,0)="40"  lbItem.Cell(40,1)="胸当て+1"  lbItem.AddRow ""  lbItem.Cell(41,0)="41"  lbItem.Cell(41,1)="鎧+1"  lbItem.AddRow ""  lbItem.Cell(42,0)="42"  lbItem.Cell(42,1)="鉄の盾+1"  lbItem.AddRow ""  lbItem.Cell(43,0)="43"  lbItem.Cell(43,1)="鉄の兜"  lbItem.AddRow ""  lbItem.Cell(44,0)="44"  lbItem.Cell(44,1)="鉄の小手"  lbItem.AddRow ""  lbItem.Cell(45,0)="45"  lbItem.Cell(45,1)="苦痛の巻物"  lbItem.AddRow ""  lbItem.Cell(46,0)="46"  lbItem.Cell(46,1)="炎の薬"  lbItem.AddRow ""  lbItem.Cell(47,0)="47"  lbItem.Cell(47,1)="短剣-1"  lbItem.AddRow ""  lbItem.Cell(48,0)="48"  lbItem.Cell(48,1)="段平-1"  lbItem.AddRow ""  lbItem.Cell(49,0)="49"  lbItem.Cell(49,1)="メイス-1"  lbItem.AddRow ""  lbItem.Cell(50,0)="50"  lbItem.Cell(50,1)="短刀-1"  lbItem.AddRow ""  lbItem.Cell(51,0)="51"  lbItem.Cell(51,1)="戦斧-1"  lbItem.AddRow ""  lbItem.Cell(52,0)="52"  lbItem.Cell(52,1)="マルゴーのﾌﾚｲﾙ"  lbItem.AddRow ""  lbItem.Cell(53,0)="53"  lbItem.Cell(53,1)="宝石の袋"  lbItem.AddRow ""  lbItem.Cell(54,0)="54"  lbItem.Cell(54,1)="魔法使いの杖"  lbItem.AddRow ""  lbItem.Cell(55,0)="55"  lbItem.Cell(55,1)="炎の段平"  lbItem.AddRow ""  lbItem.Cell(56,0)="56"  lbItem.Cell(56,1)="盾-1"  lbItem.AddRow ""  lbItem.Cell(57,0)="57"  lbItem.Cell(57,1)="皮鎧-1"  lbItem.AddRow ""  lbItem.Cell(58,0)="58"  lbItem.Cell(58,1)="鎖帷子-1"  lbItem.AddRow ""  lbItem.Cell(59,0)="59"  lbItem.Cell(59,1)="胸当て-1"  lbItem.AddRow ""  lbItem.Cell(60,0)="60"  lbItem.Cell(60,1)="鎧-1"  lbItem.AddRow ""  lbItem.Cell(61,0)="61"  lbItem.Cell(61,1)="兜-1"  lbItem.AddRow ""  lbItem.Cell(62,0)="62"  lbItem.Cell(62,1)="隠れ蓑薬"  lbItem.AddRow ""  lbItem.Cell(63,0)="63"  lbItem.Cell(63,1)="金の指輪"  lbItem.AddRow ""  lbItem.Cell(64,0)="64"  lbItem.Cell(64,1)="ｻﾗﾏﾝﾀﾞｰの指輪"  lbItem.AddRow ""  lbItem.Cell(65,0)="65"  lbItem.Cell(65,1)="蛇の牙"  lbItem.AddRow ""  lbItem.Cell(66,0)="66"  lbItem.Cell(66,1)="短剣+2"  lbItem.AddRow ""  lbItem.Cell(67,0)="67"  lbItem.Cell(67,1)="段平+2"  lbItem.AddRow ""  lbItem.Cell(68,0)="68"  lbItem.Cell(68,1)="戦斧+2"  lbItem.AddRow ""  lbItem.Cell(69,0)="69"  lbItem.Cell(69,1)="象牙の短刀(G)"  lbItem.AddRow ""  lbItem.Cell(70,0)="70"  lbItem.Cell(70,1)="黒炭の短刀(E)"  lbItem.AddRow ""  lbItem.Cell(71,0)="71"  lbItem.Cell(71,1)="琥珀の短刀(N)"  lbItem.AddRow ""  lbItem.Cell(72,0)="72"  lbItem.Cell(72,1)="メイス+2"  lbItem.AddRow ""  lbItem.Cell(73,0)="73"  lbItem.Cell(73,1)="ミスリルの小手"  lbItem.AddRow ""  lbItem.Cell(74,0)="74"  lbItem.Cell(74,1)="麻痺の魔除け"  lbItem.AddRow ""  lbItem.Cell(75,0)="75"  lbItem.Cell(75,1)="皮の鎧+2"  lbItem.AddRow ""  lbItem.Cell(76,0)="76"  lbItem.Cell(76,1)="鉄の盾+2"  lbItem.AddRow ""  lbItem.Cell(77,0)="77"  lbItem.Cell(77,1)="身かわしのローブ"  lbItem.AddRow ""  lbItem.Cell(78,0)="78"  lbItem.Cell(78,1)="鎖帷子+2"  lbItem.AddRow ""  lbItem.Cell(79,0)="79"  lbItem.Cell(79,1)="胸当て+2"  lbItem.AddRow ""  lbItem.Cell(80,0)="80"  lbItem.Cell(80,1)="鎧+2"  lbItem.AddRow ""  lbItem.Cell(81,0)="81"  lbItem.Cell(81,1)="鋼の兜"  lbItem.AddRow ""  lbItem.Cell(82,0)="82"  lbItem.Cell(82,1)="ワーガンローブ"  lbItem.AddRow ""  lbItem.Cell(83,0)="83"  lbItem.Cell(83,1)="巨人の棍棒"  lbItem.AddRow ""  lbItem.Cell(84,0)="84"  lbItem.Cell(84,1)="ｶｼﾅｰﾄの剣"  lbItem.AddRow ""  lbItem.Cell(85,0)="85"  lbItem.Cell(85,1)="羊飼いの杖"  lbItem.AddRow ""  lbItem.Cell(86,0)="86"  lbItem.Cell(86,1)="邪悪の斧"  lbItem.AddRow ""  lbItem.Cell(87,0)="87"  lbItem.Cell(87,1)="死の杖"  lbItem.AddRow ""  lbItem.Cell(88,0)="88"  lbItem.Cell(88,1)="魔除けの宝石"  lbItem.AddRow ""  lbItem.Cell(89,0)="89"  lbItem.Cell(89,1)="エメラルドの袋"  lbItem.AddRow ""  lbItem.Cell(90,0)="90"  lbItem.Cell(90,1)="ガーネットの袋"  lbItem.AddRow ""  lbItem.Cell(91,0)="91"  lbItem.Cell(91,1)="青真珠"  lbItem.AddRow ""  lbItem.Cell(92,0)="92"  lbItem.Cell(92,1)="ルビーのスリッパ"  lbItem.AddRow ""  lbItem.Cell(93,0)="93"  lbItem.Cell(93,1)="ﾈｸﾛﾏﾝｻｰの杖"  lbItem.AddRow ""  lbItem.Cell(94,0)="94"  lbItem.Cell(94,1)="命の書"  lbItem.AddRow ""  lbItem.Cell(95,0)="95"  lbItem.Cell(95,1)="死の書"  lbItem.AddRow ""  lbItem.Cell(96,0)="96"  lbItem.Cell(96,1)="ドラゴンの牙"  lbItem.AddRow ""  lbItem.Cell(97,0)="97"  lbItem.Cell(97,1)="トロールの指輪"  lbItem.AddRow ""  lbItem.Cell(98,0)="98"  lbItem.Cell(98,1)="ウサギの足"  lbItem.AddRow ""  lbItem.Cell(99,0)="99"  lbItem.Cell(99,1)="盗賊のピック"  lbItem.AddRow ""  lbItem.Cell(100,0)="100"  lbItem.Cell(100,1)="悪魔の書"  lbItem.AddRow ""  lbItem.Cell(101,0)="101"  lbItem.Cell(101,1)="蝶のナイフ"  lbItem.AddRow ""  lbItem.Cell(102,0)="102"  lbItem.Cell(102,1)="金のティアラ"  lbItem.AddRow ""  lbItem.Cell(103,0)="103"  lbItem.Cell(103,1)="カマキリの小手"  lbItem.AddRow ""  lbItem.Cell(104,0)="104"  lbItem.Cell(104,1)="村正"  lbItem.AddRow ""  lbItem.Cell(105,0)="105"  lbItem.Cell(105,1)="手裏剣"  lbItem.AddRow ""  lbItem.Cell(106,0)="106"  lbItem.Cell(106,1)="聖なる鎧"  lbItem.AddRow ""  lbItem.Cell(107,0)="107"  lbItem.Cell(107,1)="赤い靴"  lbItem.AddRow ""  lbItem.Cell(108,0)="108"  lbItem.Cell(108,1)="金の斧"  lbItem.AddRow ""  lbItem.Cell(109,0)="109"  lbItem.Cell(109,1)="黄色い耳栓"  lbItem.AddRow ""  lbItem.Cell(110,0)="110"  lbItem.Cell(110,1)="琥珀の杖"  lbItem.AddRow ""  lbItem.Cell(111,0)="255"  lbItem.Cell(111,1)="なし"  End SubWiz2Edit.Wiz2KAISEKI:Sub Wiz2KAISEKI()  Dim i As Integer  Dim rf As TextInputStream  Dim S As String  lbItem.DeleteAllRows  rf=PreferencesFolder.Child("WizEdit2解析.pref").OpenAsTextFile  if rf<>NIL then    i=0    do      s=rf.ReadLine      lbItem.AddRow ""      lbItem.Cell(i,0)=NthField(s,",",1)      lbItem.Cell(i,1)=NthField(s,",",2)      i=i+1    loop until rf.EOF    rf.Close  else    lbItem.AddRow ""    lbItem.cell(i,0)="0"    lbItem.Cell(i,1)="がらくた"    for i=1 to 140      lbItem.AddRow ""      lbItem.cell(i,0)=Str(i)      lbItem.Cell(i,1)="不明:"+Str(i)    next    lbItem.AddRow ""    lbItem.cell(i,0)="255"    lbItem.Cell(i,1)="なし"  end if  lbItem.ListIndex=0End SubWiz2Edit.EnableMenuItems:Sub EnableMenuItems()  if GetMode=false then    FileSave.Enabled=true  else    FileSave.Enabled=false  end ifEnd SubWiz2Edit.Open:Sub Open()  GetMode=falseEnd SubWiz2Edit.lbList.Open:Sub Open()  btnUp.Enabled=false  btnDown.Enabled=true  lbList.ListIndex=0End SubWiz2Edit.lbList.Change:Sub Change()  ListChangeEnd SubWiz2Edit.btnUP.Action:Sub Action()  if GetMode=false then    ListUP  end ifEnd SubWiz2Edit.btnDOWN.Action:Sub Action()  if GetMode=false then    ListDown  end ifEnd SubWiz2Edit.btnGet.Action:Sub Action()  GetMode=true  ListChange  ToEdit  me.Caption="初期値へ"  tpPrm.RefreshEnd SubWiz2Edit.btnSET.Action:Sub Action()  GetMode=false  SetPrmFromEdit  ListChange  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  btnGet.caption="編集開始"End SubWiz2Edit.btnSAVE.Action:Sub Action()  if SaveFrz(WizTwoPath) then  end ifEnd SubWiz2Edit.btnCancel.Action:Sub Action()  GetMode=false  ListChange  btnGet.caption="編集開始"End SubWiz2Edit.lbItem.KeyDown:Function KeyDown(key As String) As Boolean  Dim i As Integer  dim wf As TextoutputStream  if (Key="s")or(Key="S") then    if keyboard.shiftKey=true then      wf=PreferencesFolder.Child("WizEdit2解析.pref").CreateTextFile      for i=0 to me.ListCount-1        wf.WriteLine me.Cell(i,0)+","+me.Cell(i,1)      next      wf.Close            wf=PreferencesFolder.Child("WizEdit2解析.Text").CreateTextFile      for i=0 to me.ListCount-1        wf.WriteLine "lbItem.AddRow "+chr(34)+chr(34)        wf.WriteLine "lbItem.Cell("+Str(i)+",0)="+chr(34)+me.Cell(i,0)+chr(34)        wf.WriteLine "lbItem.Cell("+Str(i)+",1)="+chr(34)+me.Cell(i,1)+chr(34)      next      wf.Close    end if  end ifEnd FunctionWiz2Edit.lbItem.Open:Sub Open()  SetlbItemEnd SubWiz2Edit.btnSort.Action:Sub Action()  PoolToBank  ItemSort  BankToPoolEnd SubWiz2Edit.btnPeast.Action:Sub Action(Index As Integer)  ItemPeast(Index)End SubWiz2Edit.btnItemSet.Action:Sub Action()  Dim i As Integer  dim wf As TextoutputStream  lbItem.Cell(lbItem.ListIndex,1)=efItemSet.Text  efItemSet.Text=""  lbItem.ListIndex=lbItem.ListIndex+1  End SubWiz3Edit.OpenAsFrz:Function OpenAsFrz(f As FolderItem) As Boolean  Dim rf As BinaryStream  Dim i As Integer  //エラーチェック  if f.length<>FrzDataSize then    return false  end if  rf=f.OpenAsBinaryFile(false)  if rf=NIL then    return false  end if  for i=0 to FrzDataSize-1    WizThree(i)=rf.ReadByte  next  rf.Close  WizThreePath=f  //  GetMode=false  ListChange  DispAllName  return trueEnd FunctionWiz3Edit.GetName:Function GetName(index As Integer) As String  Dim nLen As Integer  Dim i As Integer  Dim s As String    nLen=WizThree(WizThreeOffSet+WizThreeDataSize*index+1)    if nLen=0 then        return "名前無し"    elseif nLen>8 then        return "無効な名前データ"    end if    s=""    for i=1 to nLen        s=s+ToMoji(WizThree(WizThreeOffSet+1+WizThreeDataSize*index+i))    next    return sEnd FunctionWiz3Edit.ToMoji:Function ToMoji(p As Integer) As String  return ToMojiT(p)End FunctionWiz3Edit.DispAllName:Sub DispAllName()  Dim i As Integer  lbList.DeleteAllRows  for i=0 to 19    lbList.AddRow GetNameAndStat(i)  next  lbList.ListIndex=0End SubWiz3Edit.ListUP:Sub ListUP()  SwapData(lbList.ListIndex,lbList.ListIndex-1)  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  lbList.List(lbList.ListIndex-1)=GetNameAndStat(lbList.ListIndex-1)  lbList.ListIndex=lbList.ListIndex-1  //lbList.RefreshEnd SubWiz3Edit.ListDown:Sub ListDown()  SwapData(lbList.ListIndex,lbList.ListIndex+1)  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  lbList.List(lbList.ListIndex+1)=GetNameAndStat(lbList.ListIndex+1)  lbList.ListIndex=lbList.ListIndex+1  //lbList.RefreshEnd SubWiz3Edit.SwapData:Sub SwapData(s As Integer, d As Integer)  Dim i,ss,dd,b As Integer  if (s<0)or(s>19)or(d<0)or(d>19)or(s=d) then    return  end if  ss=WizThreeOffSet+WizThreeDataSize*s  dd=WizThreeOffSet+WizThreeDataSize*d  for i=0 to WizThreeDataSize-1    b=WizThree(ss+i)    WizThree(ss+i)=WizThree(dd+i)    WizThree(dd+i)=b  nextEnd SubWiz3Edit.GetStatus:Function GetStatus(index As Integer) As String  Dim p,j As Integer  Dim i As Integer  Dim G,H,F As String  if (index<0)or(index>19) then    return "無効なindex値です"  end if   p=WizThree(WizThreeOffSet+WizThreeDataSize*index+10)  //まず属性  j=BitWiseAnd(p,3)  if (j mod 2)=1 then    G="N"  else    if (j\2 mod 2)=0 then      G="G"    else      G="E"    end if  end if  //種族  j=BitWiseAnd(p\32,7)  Select case j  case 0    H="Hum"  case 1    H="Elf"  case 2    H="Dwa"  case 3    H="Gno"  case 4    H="Hob"  else    H="???"  end Select  //職業  j=BitWiseAnd(p\4,7)  Select case j  case 0    F="Fig"  case 1    F="Mag"  case 2    F="Pri"  case 3    F="Thi"  case 4    F="Bis"  case 5    F="Sum"  case 6    F="Lor"  case 7    F="Nin"  else    F="???"  end Select  return G+"-"+F+" "+HEnd FunctionWiz3Edit.GetNameAndStat:Function GetNameAndStat(index As Integer) As String  Dim S As String  Dim i As Integer  s=GetName(index)  if LenB(s)<8 then    for i=1 to 8-LenB(s)      s=s+" "    next  end if  s=s+GetStatus(Index)  return sEnd FunctionWiz3Edit.ListChange:Sub ListChange()  if GetMode=false then    btnSet.Enabled=false    btnCancel.Enabled=false    btnSAVE.Enabled=true    if lbList.Enabled=false then      lbList.Enabled=true    end if    Select case lbList.ListIndex    case -1      btnUp.Enabled=false      btnDown.Enabled=false    case 0      btnUp.Enabled=false      btnDown.Enabled=true    case 19      btnUp.Enabled=true      btnDown.Enabled=false    else      btnUp.Enabled=true      btnDown.Enabled=true    end Select  else    lbList.Enabled=false    btnUp.Enabled=false    btnDown.Enabled=false    btnSet.Enabled=true    btnCancel.Enabled=true    btnSAVE.Enabled=false  end if  SetInput(GetMode)End SubWiz3Edit.ToEdit:Sub ToEdit()  Dim Index As Integer  Index=lbList.ListIndex  if (Index>=0)and(Index<=19) then    GetIndex=Index    GetPrmToEdit  end ifEnd SubWiz3Edit.GetPrmToEdit:Sub GetPrmToEdit()  Dim p,i,j As Integer  Dim S As String  p=WizThreeOffSet+WizThreeDataSize*GetIndex    //名前  stName.Text=GetName(GetIndex)    //まず属性  i=WizThree(p+10)  j=BitWiseAnd(i,3)  if (j mod 2)=1 then    pmZOKUSEI.ListIndex=1  else    if (j\2 mod 2)=0 then      pmZOKUSEI.ListIndex=0    else      pmZOKUSEI.ListIndex=2    end if  end if  //種族  pmSYUZOKU.ListIndex=BitWiseAnd(i\32,7)    //職業  pmSYOKUGYOU.ListIndex=BitWiseAnd(i\4,7)    //各種パラメータ  efCHIKARA.text=Str(WizThree(p+11))  efCHIE.text=Str(WizThree(p+12))  efSHINKOU.text=Str(WizThree(p+13))  efSEIMEI.text=Str(WizThree(p+14))  efSUBAYASA.Text=Str(WizThree(p+15))  efUN.text=Str(WizThree(p+16))    //お金  s=StrHex(WizThree(p+17))  s=s+StrHex(WizThree(p+18))  s=s+StrHex(WizThree(p+19))  s=s+StrHex(WizThree(p+20))  s=s+StrHex(WizThree(p+21))  s=s+StrHex(WizThree(p+22))    efOKANE.text=s    //経験値  s=StrHex(WizThree(p+23))  s=s+StrHex(WizThree(p+24))  s=s+StrHex(WizThree(p+25))  s=s+StrHex(WizThree(p+26))  s=s+StrHex(WizThree(p+27))  s=s+StrHex(WizThree(p+28))  efKEIKEN.text=s    //HP  efHP.Text=Str(WizThree(p+29)+WizThree(p+30)*256)  efHPMAX.Text=Str(WizThree(p+31)+WizThree(p+32)*256)    //レベル  efLEVEL.Text=Str(WizThree(p+33)*256+WizThree(p+34))    //状態  pmJOUTAI.ListIndex=WizThree(p+35)    //年齢  efNENREI.Text=Str(WizThree(p+36))    //基本AC  efAC.Text=Str(ToSignedByte(WizThree(p+38)))    //毒  if WizThree(p+84)=1 then    cbDOKU.Value=true  else    cbDOKU.Value=false  end if    //勲章">"  i=WizThree(p+88)  if BitWiseAnd(i,1)=1 then    cbKUNSYOU(1).value=true  else    cbKUNSYOU(1).value=false  end if  //勲章"G"  if BitWiseAnd(i\2,1)=1 then    cbKUNSYOU(2).value=true  else    cbKUNSYOU(2).value=false  end if  //勲章"*"  if BitWiseAnd(i\4,1)=1 then    cbKUNSYOU(3).value=true  else    cbKUNSYOU(3).value=false  end if  //Magic詠唱回数  s=""  for i=0 to 6     s=s+Str(i+1)+":"+Hex(WizThree(p+39+i)\16)+"/"+Hex(WizThree(p+39+i) mod 16)+" "  next  stMag.text=s  //Priest詠唱回数  s=""  for i=0 to 6     s=s+Str(i+1)+":"+Hex(WizThree(p+46+i)\16)+"/"+Hex(WizThree(p+46+i) mod 16)+" "  next  stPri.Text=s    //アイテム情報  ItemToBank(GetIndex)  ItemSort  BankToPoolEnd SubWiz3Edit.SetPrmFromEdit:Sub SetPrmFromEdit()  Dim p,i,j As Integer  Dim S As String  p=WizThreeOffSet+WizThreeDataSize*GetIndex    //まず属性  Select case pmZOKUSEI.ListIndex  case 0    i=0  case 1    i=1  case 2    i=2  end select    //種族*職業  WizThree(p+10)=pmSYUZOKU.ListIndex*32+pmSYOKUGYOU.ListIndex*4+i    //各種パラメータ    WizThree(p+11)=ChkPrm(Val(efCHIKARA.text))  WizThree(p+12)=ChkPrm(Val(efCHIE.text))  WizThree(p+13)=ChkPrm(Val(efSHINKOU.text))  WizThree(p+14)=ChkPrm(Val(efSEIMEI.text))  WizThree(p+15)=ChkPrm(Val(efSUBAYASA.Text))  WizThree(p+16)=ChkPrm(Val(efUN.text))    //お金  chgReet(efOKANE.text)  WizThree(p+17)=chg(0)  WizThree(p+18)=chg(1)  WizThree(p+19)=chg(2)  WizThree(p+20)=chg(3)  WizThree(p+21)=chg(4)  WizThree(p+22)=chg(5)    //経験値  chgReet(efKEIKEN.text)  WizThree(p+23)=chg(0)  WizThree(p+24)=chg(1)  WizThree(p+25)=chg(2)  WizThree(p+26)=chg(3)  WizThree(p+27)=chg(4)  WizThree(p+28)=chg(5)    //HP  i=Val(efHP.Text)  if i<1 then    i=1  elseif (i>9000) then    i=9000  end if  WizThree(p+29)=i mod 256  WizThree(p+30)=i \ 256  i=Val(efHPMAX.Text)  if i<1 then    i=1  elseif (i>9000) then    i=9000  end if  WizThree(p+31)=i mod 256  WizThree(p+32)=i \ 256    //レベル  i=Val(efLEVEL.Text)  if i<1 then    i=1  elseif (i>9999) then    i=9999  end if  WizThree(p+33)=i \ 256  WizThree(p+34)=i mod 256    //状態  WizThree(p+35)=pmJOUTAI.ListIndex    //年齢  WizThree(p+36)=Val(efNENREI.Text)    //基本AC  WizThree(p+38)=Val(efAC.Text)    //毒  if cbDOKU.Value=true then    WizThree(p+84)=1  else    WizThree(p+84)=0  end if    //勲章">"    if cbKUNSYOU(1).value=true then    i=1  else    i=0  end if  //勲章"G"  if cbKUNSYOU(2).value=true then    i=i+2  end if  //勲章"*"  if cbKUNSYOU(3).value=true then    i=i+4  end if  WizThree(p+88)=i      //呪文設定  if cbSpel(2).Value=true then    for i=0 to 6      WizThree(p+39+i)=Val("&HFF")      WizThree(p+46+i)=Val("&HFF")    next  elseif cbSpel(0).Value=true then    for i=0 to 6      WizThree(p+39+i)=Val("&H99")    next  elseif cbSpel(1).Value=true then    for i=0 to 6      WizThree(p+46+i)=Val("&H99")    next  end if  if cbSpel(5).Value=true then    for i=0 to 6      WizThree(p+53+i)=Val("&HFF")      WizThree(p+60+i)=Val("&HFF")    next  elseif cbSpel(3).Value=true then    for i=0 to 6      WizThree(p+53+i)=Val("&HFF")    next  elseif cbSpel(4).Value=true then    for i=0 to 6      WizThree(p+54+i)=Val("&HFF")    next  end if  PoolToBank  ItemSort  BankToPool  PoolToItem(p)  GetIndex=-1End SubWiz3Edit.chgReet:Sub chgReet(s As String)  Dim i,L,r As Integer  Dim ss As String  ss=s  //文字数を12文字に  L=LenB(ss)  if (L<12) then    for i=1 to 12-L      ss="0"+ss    next  elseif L>12 then    ss=Left(ss,12)  end if    chg(5)=Val("&H"+Mid(ss,11,2))  chg(4)=Val("&H"+Mid(ss,9,2))  chg(3)=Val("&H"+Mid(ss,7,2))  chg(2)=Val("&H"+Mid(ss,5,2))  chg(1)=Val("&H"+Mid(ss,3,2))  chg(0)=Val("&H"+Mid(ss,1,2))End SubWiz3Edit.SetInput:Sub SetInput(v As Boolean)  dim i As Integer  if pmZOKUSEI.Enabled<>v then    pmZOKUSEI.Enabled=v    pmSYOKUGYOU.Enabled=v    pmSYUZOKU.Enabled=v    efLEVEL.Enabled=v    efNENREI.Enabled=v    efKEIKEN.Enabled=v    efHP.Enabled=v    efHPMAX.Enabled=v    efAC.Enabled=v    efCHIKARA.Enabled=v    efCHIE.Enabled=v    efSHINKOU.Enabled=v    efSEIMEI.Enabled=v    efSUBAYASA.Enabled=v    efUN.Enabled=v    cbDOKU.Enabled=v    pmJOUTAI.Enabled=v    efOKANE.Enabled=v    for i=1 to 3      cbKUNSYOU(i).Enabled=v    next        for i=0 to 5      cbSpel(i).Enabled=v    next        for i=0 to 7      cbItem(i).Enabled=v      cbItem(i+8).Enabled=v      btnPeast(i).Enabled=v      stItem(i).Enabled=v    next    lbItem.Enabled=v    btnSort.Enabled=v      end if  if v=false then    if stName.Text<>"" then      stName.Text=""      pmZOKUSEI.ListIndex=-1      pmSYOKUGYOU.ListIndex=-1      pmSYUZOKU.ListIndex=-1      efLEVEL.Text=""      efNENREI.Text=""      efKEIKEN.Text=""      efHP.Text=""      efHPMAX.Text=""      efAC.Text=""      efCHIKARA.Text=""      efCHIE.Text=""      efSHINKOU.Text=""      efSEIMEI.Text=""      efSUBAYASA.Text=""      efUN.Text=""      cbDOKU.Value=false      pmJOUTAI.ListIndex=-1      efOKANE.Text=""      for i=1 to 3        cbKUNSYOU(i).Value=false      next      stMag.Text=""      stPri.Text=""      for i=0 to 5        cbSpel(i).Value=false      next      for i=0 to 7        cbItem(i).Value=false        cbItem(i+8).Value=false        stItem(i).text=""      next    end if  end ifEnd SubWiz3Edit.SaveFrz:Function SaveFrz(f As FolderItem) As Boolean  Dim wf As BinaryStream  Dim i As Integer  //エラーチェック  if f=NIL then    return false  end if  //  for i=0 to WizThreeDataSize*20-1    WizThree(i+WizThreeOffSet2)=WizThree(i+WizThreeOffSet)  next  wf=f.CreateBinaryFile("text")  if wf=NIL then    return false  end if  for i=0 to FrzDataSize-1    wf.WriteByte WizThree(i)  next  wf.Close  WizThreePath=f    return trueEnd FunctionWiz3Edit.ChkPrm:Function ChkPrm(p As Integer) As Integer  Dim r As Integer  r=p  if r<1 then    r=1  elseif r>30 then    r=15+18  end if  return rEnd FunctionWiz3Edit.ToSignedByte:Function ToSignedByte(p As Integer) As Integer  Dim r As Integer  r=p  if (r>127) then    r=r-256  end if  return rEnd FunctionWiz3Edit.ItemToBank:Sub ItemToBank(Index As Integer)  Dim i,j,p As Integer  p=WizThreeOffSet+WizThreeDataSize*Index  for i=0 to 7    ItemSoubi(i)=false    ItemName(i)=false    ItemBank(i)=255  next  for i=0 to 7    j=WizThree(p+67+i)    //装備    if ((j\128)mod 2)=1 then      ItemSoubi(i)=true    end if    //不確定名    if ((j\32)mod 2)=1 then      ItemName(i)=true    end if    if WizThree(p+75+i)<=137 then      ItemBank(i)=WizThree(p+75+i)    end if  nextEnd SubWiz3Edit.ItemPeast:Sub ItemPeast(index As Integer)  if lbItem.ListIndex>=0 then    ItemPool(Index)=Val(lbItem.Cell(lbItem.ListIndex,0))    stItem(Index).text=lbItem.Cell(lbItem.ListIndex,1)    cbItem(Index).Value=false    cbItem(Index+8).Value=false  end ifEnd SubWiz3Edit.PoolToBank:Sub PoolToBank()  Dim i As Integer  for i=0 to 7    //装備    ItemSoubi(i)=cbItem(i).Value    ItemName(i)=cbItem(i+8).Value    ItemBank(i)=ItemPool(i)  nextEnd SubWiz3Edit.BankToPool:Sub BankToPool()  Dim i As Integer  for i=0 to 7    cbItem(i).value=ItemSoubi(i)    cbItem(i+8).value=ItemName(i)    ItemPool(i)=ItemBank(i)    if ItemBank(i)<=lbItem.ListCount then      stItem(i).text=lbItem.Cell(ItemBank(i),1)    else      stItem(i).text="なし"    end if  nextEnd SubWiz3Edit.PoolToItem:Sub PoolToItem(p As Integer)  Dim i,j,k As Integer  k=0  for i=0 to 7    j=0    if cbItem(i).Value=true then      j=128    end if    if cbItem(i+8).Value=true then      j=j+32    end if    WizThree(p+67+i)=j        WizThree(p+75+i)=ItemPool(i)    if ItemPool(i)<>255 then      k=k+1    end if  next  WizThree(p+83)=kEnd SubWiz3Edit.Wiz3KAISEKI:Sub Wiz3KAISEKI()  Dim i As Integer  Dim rf As TextInputStream  Dim S As String  lbItem.DeleteAllRows  rf=PreferencesFolder.Child("WizEdit解析.pref").OpenAsTextFile  if rf<>NIL then    i=0    do      s=rf.ReadLine      lbItem.AddRow ""      lbItem.Cell(i,0)=NthField(s,",",1)      lbItem.Cell(i,1)=NthField(s,",",2)      i=i+1    loop until rf.EOF    rf.Close  else    lbItem.AddRow ""    lbItem.cell(i,0)="0"    lbItem.Cell(i,1)="がらくた"    for i=1 to 137      lbItem.AddRow ""      lbItem.cell(i,0)=Str(i)      lbItem.Cell(i,1)="不明:"+Str(i)    next    lbItem.AddRow ""    lbItem.cell(i,0)="255"    lbItem.Cell(i,1)="なし"  end if  lbItem.ListIndex=0End SubWiz3Edit.SetlbItem:Sub SetlbItem()  lbItem.DeleteAllRows  lbItem.AddRow ""  lbItem.Cell(0,0)="0"  lbItem.Cell(0,1)="がらくた"  lbItem.AddRow ""  lbItem.Cell(1,0)="1"  lbItem.Cell(1,1)="剣"  lbItem.AddRow ""  lbItem.Cell(2,0)="2"  lbItem.Cell(2,1)="短剣"  lbItem.AddRow ""  lbItem.Cell(3,0)="3"  lbItem.Cell(3,1)="メイス"  lbItem.AddRow ""  lbItem.Cell(4,0)="4"  lbItem.Cell(4,1)="フレイル"  lbItem.AddRow ""  lbItem.Cell(5,0)="5"  lbItem.Cell(5,1)="つえ"  lbItem.AddRow ""  lbItem.Cell(6,0)="6"  lbItem.Cell(6,1)="短刀"  lbItem.AddRow ""  lbItem.Cell(7,0)="7"  lbItem.Cell(7,1)="バックラー"  lbItem.AddRow ""  lbItem.Cell(8,0)="8"  lbItem.Cell(8,1)="盾"  lbItem.AddRow ""  lbItem.Cell(9,0)="9"  lbItem.Cell(9,1)="ローブ"  lbItem.AddRow ""  lbItem.Cell(10,0)="10"  lbItem.Cell(10,1)="皮鎧"  lbItem.AddRow ""  lbItem.Cell(11,0)="11"  lbItem.Cell(11,1)="くさりかたびら"  lbItem.AddRow ""  lbItem.Cell(12,0)="12"  lbItem.Cell(12,1)="胸当"  lbItem.AddRow ""  lbItem.Cell(13,0)="13"  lbItem.Cell(13,1)="鎧"  lbItem.AddRow ""  lbItem.Cell(14,0)="14"  lbItem.Cell(14,1)="兜"  lbItem.AddRow ""  lbItem.Cell(15,0)="15"  lbItem.Cell(15,1)="傷薬"  lbItem.AddRow ""  lbItem.Cell(16,0)="16"  lbItem.Cell(16,1)="毒消し"  lbItem.AddRow ""  lbItem.Cell(17,0)="17"  lbItem.Cell(17,1)="切り裂きの剣"  lbItem.AddRow ""  lbItem.Cell(18,0)="18"  lbItem.Cell(18,1)="鋭い短剣"  lbItem.AddRow ""  lbItem.Cell(19,0)="19"  lbItem.Cell(19,1)="粉砕のメイス"  lbItem.AddRow ""  lbItem.Cell(20,0)="20"  lbItem.Cell(20,1)="鉄の杖"  lbItem.AddRow ""  lbItem.Cell(21,0)="21"  lbItem.Cell(21,1)="眠りの巻物"  lbItem.AddRow ""  lbItem.Cell(22,0)="22"  lbItem.Cell(22,1)="堅い皮鎧"  lbItem.AddRow ""  lbItem.Cell(23,0)="23"  lbItem.Cell(23,1)="光る鎖肩びら"  lbItem.AddRow ""  lbItem.Cell(24,0)="24"  lbItem.Cell(24,1)="ますらおの鎧"  lbItem.AddRow ""  lbItem.Cell(25,0)="25"  lbItem.Cell(25,1)="鉄の盾"  lbItem.AddRow ""  lbItem.Cell(26,0)="26"  lbItem.Cell(26,1)="銅鎧"  lbItem.AddRow ""  lbItem.Cell(27,0)="27"  lbItem.Cell(27,1)="痛みの巻物"  lbItem.AddRow ""  lbItem.Cell(28,0)="28"  lbItem.Cell(28,1)="炎の巻物"  lbItem.AddRow ""  lbItem.Cell(29,0)="29"  lbItem.Cell(29,1)="諸刃の剣"  lbItem.AddRow ""  lbItem.Cell(30,0)="30"  lbItem.Cell(30,1)="幻滅の短剣"  lbItem.AddRow ""  lbItem.Cell(31,0)="31"  lbItem.Cell(31,1)="災いのメイス"  lbItem.AddRow ""  lbItem.Cell(32,0)="32"  lbItem.Cell(32,1)="堅い杖"  lbItem.AddRow ""  lbItem.Cell(33,0)="33"  lbItem.Cell(33,1)="ﾄﾞﾗｺﾞﾝｽﾚｲﾔｰ"  lbItem.AddRow ""  lbItem.Cell(34,0)="34"  lbItem.Cell(34,1)="忍耐の兜"  lbItem.AddRow ""  lbItem.Cell(35,0)="35"  lbItem.Cell(35,1)="腐った皮鎧"  lbItem.AddRow ""  lbItem.Cell(36,0)="36"  lbItem.Cell(36,1)="錆びた鎖肩びら"  lbItem.AddRow ""  lbItem.Cell(37,0)="37"  lbItem.Cell(37,1)="歴戦の胸当て"  lbItem.AddRow ""  lbItem.Cell(38,0)="38"  lbItem.Cell(38,1)="歪んだ盾"  lbItem.AddRow ""  lbItem.Cell(39,0)="39"  lbItem.Cell(39,1)="宝石の指輪"  lbItem.AddRow ""  lbItem.Cell(40,0)="40"  lbItem.Cell(40,1)="苦しみの巻物"  lbItem.AddRow ""  lbItem.Cell(41,0)="41"  lbItem.Cell(41,1)="煙玉"  lbItem.AddRow ""  lbItem.Cell(42,0)="42"  lbItem.Cell(42,1)="真っ二つの剣"  lbItem.AddRow ""  lbItem.Cell(43,0)="43"  lbItem.Cell(43,1)="最強の短剣"  lbItem.AddRow ""  lbItem.Cell(44,0)="44"  lbItem.Cell(44,1)="力のメイス"  lbItem.AddRow ""  lbItem.Cell(45,0)="45"  lbItem.Cell(45,1)="導きの巻物"  lbItem.AddRow ""  lbItem.Cell(46,0)="46"  lbItem.Cell(46,1)="目眩ましの巻物"  lbItem.AddRow ""  lbItem.Cell(47,0)="47"  lbItem.Cell(47,1)="銅の小手"  lbItem.AddRow ""  lbItem.Cell(48,0)="48"  lbItem.Cell(48,1)="豪華な皮鎧"  lbItem.AddRow ""  lbItem.Cell(49,0)="49"  lbItem.Cell(49,1)="エルフの鎖肩平"  lbItem.AddRow ""  lbItem.Cell(50,0)="50"  lbItem.Cell(50,1)="極上の鎧"  lbItem.AddRow ""  lbItem.Cell(51,0)="51"  lbItem.Cell(51,1)="支えの盾"  lbItem.AddRow ""  lbItem.Cell(52,0)="52"  lbItem.Cell(52,1)="悪の兜"  lbItem.AddRow ""  lbItem.Cell(53,0)="53"  lbItem.Cell(53,1)="特効薬"  lbItem.AddRow ""  lbItem.Cell(54,0)="54"  lbItem.Cell(54,1)="守りの指輪"  lbItem.AddRow ""  lbItem.Cell(55,0)="55"  lbItem.Cell(55,1)="ワースレイヤー"  lbItem.AddRow ""  lbItem.Cell(56,0)="56"  lbItem.Cell(56,1)="ﾒｲｼﾞﾏｯｼｬｰ"  lbItem.AddRow ""  lbItem.Cell(57,0)="57"  lbItem.Cell(57,1)="蛇のメイス"  lbItem.AddRow ""  lbItem.Cell(58,0)="58"  lbItem.Cell(58,1)="沈黙の杖"  lbItem.AddRow ""  lbItem.Cell(59,0)="59"  lbItem.Cell(59,1)="ｶｼﾅｰﾄの剣"  lbItem.AddRow ""  lbItem.Cell(60,0)="60"  lbItem.Cell(60,1)="戒めの指輪"  lbItem.AddRow ""  lbItem.Cell(61,0)="61"  lbItem.Cell(61,1)="炎の杖"  lbItem.AddRow ""  lbItem.Cell(62,0)="62"  lbItem.Cell(62,1)="悪の鎖帷子"  lbItem.AddRow ""  lbItem.Cell(63,0)="63"  lbItem.Cell(63,1)="中立の鎧"  lbItem.AddRow ""  lbItem.Cell(64,0)="64"  lbItem.Cell(64,1)="悪の盾"  lbItem.AddRow ""  lbItem.Cell(65,0)="65"  lbItem.Cell(65,1)="窒息の指輪"  lbItem.AddRow ""  lbItem.Cell(66,0)="66"  lbItem.Cell(66,1)="転移の兜"  lbItem.AddRow ""  lbItem.Cell(67,0)="67"  lbItem.Cell(67,1)="一撃の巻物"  lbItem.AddRow ""  lbItem.Cell(68,0)="68"  lbItem.Cell(68,1)="破滅の短剣"  lbItem.AddRow ""  lbItem.Cell(69,0)="69"  lbItem.Cell(69,1)="切り裂きの短刀"  lbItem.AddRow ""  lbItem.Cell(70,0)="70"  lbItem.Cell(70,1)="病めるメイス"  lbItem.AddRow ""  lbItem.Cell(71,0)="71"  lbItem.Cell(71,1)="ねじれた杖"  lbItem.AddRow ""  lbItem.Cell(72,0)="72"  lbItem.Cell(72,1)="早業の短刀"  lbItem.AddRow ""  lbItem.Cell(73,0)="73"  lbItem.Cell(73,1)="呪われたローブ"  lbItem.AddRow ""  lbItem.Cell(74,0)="74"  lbItem.Cell(74,1)="破滅の皮鎧"  lbItem.AddRow ""  lbItem.Cell(75,0)="75"  lbItem.Cell(75,1)="呪いの鎖帷子"  lbItem.AddRow ""  lbItem.Cell(76,0)="76"  lbItem.Cell(76,1)="悪魔の胸当て"  lbItem.AddRow ""  lbItem.Cell(77,0)="77"  lbItem.Cell(77,1)="虚ろの盾"  lbItem.AddRow ""  lbItem.Cell(78,0)="78"  lbItem.Cell(78,1)="古びた兜"  lbItem.AddRow ""  lbItem.Cell(79,0)="79"  lbItem.Cell(79,1)="希望の胸当て"  lbItem.AddRow ""  lbItem.Cell(80,0)="80"  lbItem.Cell(80,1)="銀の小手"  lbItem.AddRow ""  lbItem.Cell(81,0)="81"  lbItem.Cell(81,1)="破滅の皮鎧"  lbItem.AddRow ""  lbItem.Cell(82,0)="82"  lbItem.Cell(82,1)="ｿｳﾙｽﾚｲﾔｰ"  lbItem.AddRow ""  lbItem.Cell(83,0)="83"  lbItem.Cell(83,1)="盗賊の短刀"  lbItem.AddRow ""  lbItem.Cell(84,0)="84"  lbItem.Cell(84,1)="英雄の鎧"  lbItem.AddRow ""  lbItem.Cell(85,0)="85"  lbItem.Cell(85,1)="聖なる鎧"  lbItem.AddRow ""  lbItem.Cell(86,0)="86"  lbItem.Cell(86,1)="村正"  lbItem.AddRow ""  lbItem.Cell(87,0)="87"  lbItem.Cell(87,1)="手裏剣"  lbItem.AddRow ""  lbItem.Cell(88,0)="88"  lbItem.Cell(88,1)="氷の鎖帷子"  lbItem.AddRow ""  lbItem.Cell(89,0)="89"  lbItem.Cell(89,1)="悪の鎧"  lbItem.AddRow ""  lbItem.Cell(90,0)="90"  lbItem.Cell(90,1)="守りの盾"  lbItem.AddRow ""  lbItem.Cell(91,0)="91"  lbItem.Cell(91,1)="快復の指輪"  lbItem.AddRow ""  lbItem.Cell(92,0)="92"  lbItem.Cell(92,1)="覇邪の指輪"  lbItem.AddRow ""  lbItem.Cell(93,0)="93"  lbItem.Cell(93,1)="死の指輪"  lbItem.AddRow ""  lbItem.Cell(94,0)="94"  lbItem.Cell(94,1)="復活の杖"  lbItem.AddRow ""  lbItem.Cell(95,0)="95"  lbItem.Cell(95,1)="古のお守り"  lbItem.AddRow ""  lbItem.Cell(96,0)="96"  lbItem.Cell(96,1)="身かわしのローブ"  lbItem.AddRow ""  lbItem.Cell(97,0)="97"  lbItem.Cell(97,1)="手袋"  lbItem.AddRow ""  lbItem.Cell(98,0)="98"  lbItem.Cell(98,1)="魔封じのﾈｯｸﾚｽ"  lbItem.AddRow ""  lbItem.Cell(99,0)="99"  lbItem.Cell(99,1)="光の杖"  lbItem.AddRow ""  lbItem.Cell(100,0)="100"  lbItem.Cell(100,1)="エクスカリバー"  lbItem.AddRow ""  lbItem.Cell(101,0)="101"  lbItem.Cell(101,1)="閃きの剣"  lbItem.AddRow ""  lbItem.Cell(102,0)="102"  lbItem.Cell(102,1)="ﾌﾟﾘｰｽﾄﾊﾟﾝﾁｬｰ"  lbItem.AddRow ""  lbItem.Cell(103,0)="103"  lbItem.Cell(103,1)="僧侶のメイス"  lbItem.AddRow ""  lbItem.Cell(104,0)="104"  lbItem.Cell(104,1)="閃きの短剣"  lbItem.AddRow ""  lbItem.Cell(105,0)="105"  lbItem.Cell(105,1)="炎の指輪"  lbItem.AddRow ""  lbItem.Cell(106,0)="106"  lbItem.Cell(106,1)="呪われた鎧"  lbItem.AddRow ""  lbItem.Cell(107,0)="107"  lbItem.Cell(107,1)="ミスリルの鎧"  lbItem.AddRow ""  lbItem.Cell(108,0)="108"  lbItem.Cell(108,1)="癒しの杖"  lbItem.AddRow ""  lbItem.Cell(109,0)="109"  lbItem.Cell(109,1)="命の指輪"  lbItem.AddRow ""  lbItem.Cell(110,0)="110"  lbItem.Cell(110,1)="変化の指輪"  lbItem.AddRow ""  lbItem.Cell(111,0)="111"  lbItem.Cell(111,1)="不思議な石"  lbItem.AddRow ""  lbItem.Cell(112,0)="112"  lbItem.Cell(112,1)="希望の石"  lbItem.AddRow ""  lbItem.Cell(113,0)="113"  lbItem.Cell(113,1)="神秘的な石"  lbItem.AddRow ""  lbItem.Cell(114,0)="114"  lbItem.Cell(114,1)="偉大なる魔法の杖"  lbItem.AddRow ""  lbItem.Cell(115,0)="115"  lbItem.Cell(115,1)="力のコイン1"  lbItem.AddRow ""  lbItem.Cell(116,0)="116"  lbItem.Cell(116,1)="若返りの石"  lbItem.AddRow ""  lbItem.Cell(117,0)="117"  lbItem.Cell(117,1)="心の石"  lbItem.AddRow ""  lbItem.Cell(118,0)="118"  lbItem.Cell(118,1)="信心の石"  lbItem.AddRow ""  lbItem.Cell(119,0)="119"  lbItem.Cell(119,1)="ﾌﾞﾗｰﾆｨの石"  lbItem.AddRow ""  lbItem.Cell(120,0)="120"  lbItem.Cell(120,1)="熟練の魔除け"  lbItem.AddRow ""  lbItem.Cell(121,0)="121"  lbItem.Cell(121,1)="熟練の魔除け"  lbItem.AddRow ""  lbItem.Cell(122,0)="122"  lbItem.Cell(122,1)="偉大なる魔法使いの杖"  lbItem.AddRow ""  lbItem.Cell(123,0)="123"  lbItem.Cell(123,1)="力のコイン2"  lbItem.AddRow ""  lbItem.Cell(124,0)="124"  lbItem.Cell(124,1)="ニルダの杖"  lbItem.AddRow ""  lbItem.Cell(125,0)="125"  lbItem.Cell(125,1)="ハースニール"  lbItem.AddRow ""  lbItem.Cell(126,0)="126"  lbItem.Cell(126,1)="伝説の兜"  lbItem.AddRow ""  lbItem.Cell(127,0)="127"  lbItem.Cell(127,1)="伝説の盾"  lbItem.AddRow ""  lbItem.Cell(128,0)="128"  lbItem.Cell(128,1)="伝説の小手"  lbItem.AddRow ""  lbItem.Cell(129,0)="129"  lbItem.Cell(129,1)="伝説の鎧"  lbItem.AddRow ""  lbItem.Cell(130,0)="130"  lbItem.Cell(130,1)="錆びた鍵"  lbItem.AddRow ""  lbItem.Cell(131,0)="131"  lbItem.Cell(131,1)="血塗れﾊﾞｯﾁ"  lbItem.AddRow ""  lbItem.Cell(132,0)="132"  lbItem.Cell(132,1)="奇妙な紋章"  lbItem.AddRow ""  lbItem.Cell(133,0)="133"  lbItem.Cell(133,1)="黒炭の鍵"  lbItem.AddRow ""  lbItem.Cell(134,0)="134"  lbItem.Cell(134,1)="修道院の鍵"  lbItem.AddRow ""  lbItem.Cell(135,0)="135"  lbItem.Cell(135,1)="ミスリルの鍵"  lbItem.AddRow ""  lbItem.Cell(136,0)="136"  lbItem.Cell(136,1)="マスターキー"  lbItem.AddRow ""  lbItem.Cell(137,0)="137"  lbItem.Cell(137,1)="悪魔の石"  lbItem.AddRow ""  lbItem.Cell(138,0)="255"  lbItem.Cell(138,1)="なし"  End SubWiz3Edit.EnableMenuItems:Sub EnableMenuItems()  if GetMode=false then    FileSave.Enabled=true  else    FileSave.Enabled=false  end ifEnd SubWiz3Edit.Open:Sub Open()  GetMode=falseEnd SubWiz3Edit.lbList.Open:Sub Open()  btnUp.Enabled=false  btnDown.Enabled=true  lbList.ListIndex=0End SubWiz3Edit.lbList.Change:Sub Change()  ListChangeEnd SubWiz3Edit.btnUP.Action:Sub Action()  if GetMode=false then    ListUP  end ifEnd SubWiz3Edit.btnDOWN.Action:Sub Action()  if GetMode=false then    ListDown  end ifEnd SubWiz3Edit.btnGet.Action:Sub Action()  GetMode=true  ListChange  ToEdit  me.Caption="初期値へ"  tpPrm.RefreshEnd SubWiz3Edit.btnSET.Action:Sub Action()  GetMode=false  SetPrmFromEdit  ListChange  lbList.List(lbList.ListIndex)=GetNameAndStat(lbList.ListIndex)  btnGet.caption="編集開始"End SubWiz3Edit.btnSAVE.Action:Sub Action()  if SaveFrz(WizThreePath) then  end ifEnd SubWiz3Edit.btnCancel.Action:Sub Action()  GetMode=false  ListChange  btnGet.caption="編集開始"End SubWiz3Edit.lbItem.KeyDown:Function KeyDown(key As String) As Boolean  Dim i As Integer  dim wf As TextoutputStream  if (Key="s")or(Key="S") then    if keyboard.shiftKey=true then      wf=PreferencesFolder.Child("WizEdit解析.pref").CreateTextFile      for i=0 to me.ListCount-1        wf.WriteLine me.Cell(i,0)+","+me.Cell(i,1)      next      wf.Close            wf=PreferencesFolder.Child("WizEdit解析.Text").CreateTextFile      for i=0 to me.ListCount-1        wf.WriteLine "lbItem.AddRow "+chr(34)+chr(34)        wf.WriteLine "lbItem.Cell("+Str(i)+",0)="+chr(34)+me.Cell(i,0)+chr(34)        wf.WriteLine "lbItem.Cell("+Str(i)+",1)="+chr(34)+me.Cell(i,1)+chr(34)      next      wf.Close    end if  end ifEnd FunctionWiz3Edit.lbItem.Open:Sub Open()  SetlbItemEnd SubWiz3Edit.btnSort.Action:Sub Action()  PoolToBank  ItemSort  BankToPoolEnd SubWiz3Edit.btnPeast.Action:Sub Action(Index As Integer)  ItemPeast(Index)End SubWiz3Edit.btnItemSet.Action:Sub Action()  Dim i As Integer  dim wf As TextoutputStream  lbItem.Cell(lbItem.ListIndex,1)=efItemSet.Text  efItemSet.Text=""  lbItem.ListIndex=lbItem.ListIndex+1  //wf=PreferencesFolder.Child("WizEdit解析.Text").CreateTextFile  //for i=0 to lbItem.ListCount-1  //wf.WriteLine "lbItem.AddRow "+chr(34)+chr(34)  //wf.WriteLine "lbItem.Cell("+Str(i)+",0)="+chr(34)+lbItem.Cell(i,0)+chr(34)  //wf.WriteLine "lbItem.Cell("+Str(i)+",1)="+chr(34)+lbItem.Cell(i,1)+chr(34)  //next  //wf.CloseEnd SubAbout1.MouseDown:Function MouseDown(X As Integer, Y As Integer) As Boolean  closeEnd FunctionAbout1.KeyDown:Function KeyDown(Key As String) As Boolean  closeEnd Function